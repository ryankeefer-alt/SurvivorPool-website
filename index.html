<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>March Madness Knockout Pool 2025</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Anton&family=Karla:wght@300;400;500;600;700&family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg:      #080808;
      --surface: #111111;
      --raised:  #1a1a1a;
      --float:   #222222;
      --border:  rgba(255,255,255,0.08);
      --accent:  #F4631F;
      --gold:    #FFB800;
      --cream:   #F2E8D9;
      --text:    #F2E8D9;
      --muted:   #8a7a6a;
      --dim:     #4a3a2a;
      --success: #4ade80;
      --danger:  #f87171;
      --warn:    #FFB800;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Karla', system-ui, sans-serif;
      font-size: 15px;
      line-height: 1.7;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .anton { font-family: 'Anton', sans-serif; letter-spacing: 0.02em; }
    .mono { font-family: 'Courier Prime', monospace; }

    ::-webkit-scrollbar { width: 4px; height: 4px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--dim); border-radius: 2px; }

    @keyframes fadeUp {
      from { opacity:0; transform:translateY(16px); }
      to   { opacity:1; transform:translateY(0); }
    }
    @keyframes bounce-ball {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      30%       { transform: translateY(-22px) rotate(-15deg); }
      60%       { transform: translateY(0) rotate(5deg); }
      80%       { transform: translateY(-8px) rotate(-5deg); }
    }
    @keyframes spin-ball {
      0%   { transform: rotate(0deg) scale(1); }
      25%  { transform: rotate(90deg) scale(1.06); }
      50%  { transform: rotate(180deg) scale(1); }
      75%  { transform: rotate(270deg) scale(1.06); }
      100% { transform: rotate(360deg) scale(1); }
    }
    @keyframes glow-pulse {
      0%, 100% { opacity: .6; }
      50%       { opacity: 1; }
    }
    @keyframes shimmer {
      0%   { background-position: -200% 0; }
      100% { background-position:  200% 0; }
    }
    .anim-up   { animation: fadeUp .45s cubic-bezier(.22,1,.36,1) both; }
    .anim-up-1 { animation-delay:  60ms; }
    .anim-up-2 { animation-delay: 120ms; }
    .anim-up-3 { animation-delay: 180ms; }
    .anim-up-4 { animation-delay: 240ms; }
    .anim-up-5 { animation-delay: 300ms; }
    .anim-up-6 { animation-delay: 360ms; }
    .anim-up-7 { animation-delay: 420ms; }

    /* â”€â”€ Court texture â”€â”€ */
    .court-texture {
      background-color: var(--bg);
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 59px, rgba(255,255,255,.03) 59px, rgba(255,255,255,.03) 60px),
        repeating-linear-gradient(90deg, transparent, transparent 59px, rgba(255,255,255,.03) 59px, rgba(255,255,255,.03) 60px);
    }

    /* â”€â”€ Header â”€â”€ */
    .site-header {
      position: sticky; top: 0; z-index: 50;
      background: rgba(8,8,8,.95);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--border);
      overflow: hidden;
    }
    .header-flame {
      position: absolute; inset: 0; pointer-events: none;
      background: radial-gradient(ellipse 70% 200% at 80% 50%, rgba(244,99,31,.14) 0%, transparent 65%);
    }

    /* â”€â”€ Nav â”€â”€ */
    .nav-tab {
      display:flex; align-items:center; gap:7px;
      padding: 14px 20px; font-size: 13px; font-weight: 600;
      letter-spacing: 0.06em; text-transform: uppercase;
      color: var(--muted); cursor: pointer; white-space: nowrap;
      border-bottom: 2px solid transparent;
      transition: color .2s, border-color .2s;
    }
    .nav-tab:hover { color: var(--cream); }
    .nav-tab.active { color: var(--accent); border-bottom-color: var(--accent); }

    /* â”€â”€ Cards â”€â”€ */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }
    .card-header {
      padding: 18px 22px 16px;
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
    }
    .card-title {
      font-family: 'Anton', sans-serif;
      font-size: 15px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--cream);
    }

    /* â”€â”€ Badges â”€â”€ */
    .badge {
      display: inline-flex; align-items: center; gap: 4px;
      padding: 3px 10px; border-radius: 4px;
      font-size: 11px; font-weight: 700;
      letter-spacing: 0.08em; text-transform: uppercase;
    }
    .badge-alive   { background: rgba(74,222,128,.12); color: var(--success); border: 1px solid rgba(74,222,128,.25); }
    .badge-out     { background: rgba(248,113,113,.1); color: var(--danger);  border: 1px solid rgba(248,113,113,.2); }
    .badge-buyback { background: rgba(255,184,0,.12);  color: var(--gold);    border: 1px solid rgba(255,184,0,.25); }
    .badge-win     { background: rgba(74,222,128,.12); color: var(--success); border: 1px solid rgba(74,222,128,.25); }
    .badge-loss    { background: rgba(248,113,113,.1); color: var(--danger);  border: 1px solid rgba(248,113,113,.2); }
    .badge-pending { background: rgba(255,184,0,.1);  color: var(--gold);    border: 1px solid rgba(255,184,0,.2);  }

    /* â”€â”€ Buttons â”€â”€ */
    .btn {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 10px 22px; border-radius: 8px; border: none; cursor: pointer;
      font-family: 'Karla', sans-serif; font-size: 14px; font-weight: 700;
      letter-spacing: 0.04em;
      transition: transform .15s, box-shadow .15s, opacity .15s;
    }
    .btn:hover   { transform: translateY(-1px); }
    .btn:active  { transform: translateY(0); }
    .btn:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
    .btn-primary {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 4px 20px rgba(244,99,31,.4), 0 1px 3px rgba(0,0,0,.5);
    }
    .btn-primary:hover {
      box-shadow: 0 6px 28px rgba(244,99,31,.55), 0 2px 6px rgba(0,0,0,.5);
    }
    .btn-gold {
      background: var(--gold);
      color: #111;
      box-shadow: 0 4px 20px rgba(255,184,0,.35), 0 1px 3px rgba(0,0,0,.5);
    }
    .btn-ghost {
      background: transparent;
      color: var(--muted);
      border: 1px solid var(--border);
    }
    .btn-ghost:hover { color: var(--text); border-color: rgba(255,255,255,.2); }

    /* â”€â”€ Game rows â”€â”€ */
    .game-row {
      padding: 14px 22px;
      border-bottom: 1px solid var(--border);
      transition: background .15s;
    }
    .game-row:last-child { border-bottom: none; }
    .game-row:hover { background: rgba(255,255,255,.025); }

    /* â”€â”€ Player rows â”€â”€ */
    .player-row {
      padding: 14px 22px;
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; gap: 14px;
      transition: background .15s;
    }
    .player-row:last-child { border-bottom: none; }
    .player-row:hover { background: rgba(255,255,255,.025); }

    /* â”€â”€ Form â”€â”€ */
    .form-label {
      display: block;
      font-size: 11px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase;
      color: var(--muted); margin-bottom: 6px;
    }
    .form-input, .form-select {
      width: 100%; padding: 11px 14px;
      background: var(--raised); border: 1px solid var(--border);
      border-radius: 8px; color: var(--text);
      font-family: 'Karla', sans-serif; font-size: 14px;
      transition: border-color .2s, box-shadow .2s;
    }
    .form-input:focus, .form-select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(244,99,31,.15);
    }
    .form-input::placeholder { color: var(--muted); }
    .form-select option { background: var(--raised); }

    /* â”€â”€ Admin table â”€â”€ */
    .admin-table { width: 100%; border-collapse: collapse; }
    .admin-table th {
      padding: 10px 14px; text-align: left;
      font-size: 11px; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase;
      color: var(--muted); border-bottom: 1px solid var(--border);
    }
    .admin-table td {
      padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,.04);
      font-size: 13.5px; vertical-align: middle;
    }
    .admin-table tr:hover td { background: rgba(255,255,255,.025); }

    /* â”€â”€ Venmo banner â”€â”€ */
    .venmo-bar {
      background: linear-gradient(135deg, #008CFF 0%, #00B3FF 100%);
      padding: 3px 0; text-align: center;
      font-size: 12px; font-weight: 700; letter-spacing: 0.05em;
      color: #fff;
    }

    /* â”€â”€ Scoreboard â”€â”€ */
    .score-pill {
      font-family: 'Courier Prime', monospace;
      font-size: 13px; font-weight: 700;
      min-width: 26px; text-align: center;
      padding: 2px 8px;
      background: var(--raised); border-radius: 4px;
      border: 1px solid var(--border);
    }

    /* â”€â”€ Rules â”€â”€ */
    .rule-card {
      background: var(--raised);
      border-left: 3px solid var(--accent);
      border-radius: 0 8px 8px 0;
      padding: 14px 18px;
    }
    .rule-card.gold { border-left-color: var(--gold); }

    /* â”€â”€ Toggle â”€â”€ */
    .toggle-pill {
      display: inline-flex;
      background: var(--raised);
      border: 1px solid var(--border);
      border-radius: 100px;
      padding: 3px;
    }
    .toggle-opt {
      padding: 6px 16px; border-radius: 100px; cursor: pointer;
      font-size: 12px; font-weight: 700; letter-spacing: 0.05em; text-transform: uppercase;
      color: var(--muted); transition: all .2s;
    }
    .toggle-opt.active { background: var(--accent); color: #fff; }

    /* â”€â”€ Tabs â”€â”€ */
    .subtab {
      padding: 8px 16px; border-radius: 6px; cursor: pointer;
      font-size: 12px; font-weight: 700; letter-spacing: 0.05em; text-transform: uppercase;
      color: var(--muted); transition: all .2s;
    }
    .subtab.active { background: var(--raised); color: var(--text); }
    .subtab:hover:not(.active) { color: var(--cream); }

    /* â”€â”€ Divider â”€â”€ */
    .divider { border: none; border-top: 1px solid var(--border); }

    /* â”€â”€ Pool stat cards â”€â”€ */
    .stat-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px 22px;
      position: relative; overflow: hidden;
    }
    .stat-card::before {
      content:''; position:absolute; top:0; left:0; right:0; height:2px;
    }
    .stat-card.orange::before { background: var(--accent); }
    .stat-card.gold::before   { background: var(--gold); }
    .stat-card.green::before  { background: var(--success); }
    .stat-card.red::before    { background: #ef4444; }
    .stat-card.blue::before   { background: #3b82f6; }
    .stat-card.white::before  { background: #e5e7eb; }
  </style>
</head>
<body class="court-texture">

<div id="root"></div>

<script type="text/babel">
const { useState, useMemo, useCallback, useEffect } = React;

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SVG Basketball Component
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const Basketball = ({ size = 60, bounce = false, spin = false, className = '', glow = false }) => (
  <div
    className={className}
    style={{
      width: size, height: size, flexShrink: 0,
      animation: spin
        ? 'spin-ball 2.4s cubic-bezier(.4,0,.6,1) infinite'
        : bounce ? 'bounce-ball 1.8s cubic-bezier(.36,.07,.19,.97) infinite' : 'none',
      filter: glow ? `drop-shadow(0 0 ${size * 0.18}px rgba(244,99,31,.75)) drop-shadow(0 0 ${size * 0.35}px rgba(244,99,31,.3))` : 'none',
    }}
  >
    <svg viewBox="0 0 100 100" width={size} height={size}>
      <defs>
        <radialGradient id={`bg${size}`} cx="38%" cy="32%">
          <stop offset="0%"   stopColor="#FF8C42" />
          <stop offset="45%"  stopColor="#F4631F" />
          <stop offset="100%" stopColor="#B33A00" />
        </radialGradient>
        <radialGradient id={`shine${size}`} cx="32%" cy="28%">
          <stop offset="0%"   stopColor="rgba(255,255,255,.35)" />
          <stop offset="100%" stopColor="rgba(255,255,255,0)" />
        </radialGradient>
        <clipPath id={`clip${size}`}>
          <circle cx="50" cy="50" r="47" />
        </clipPath>
      </defs>
      <circle cx="50" cy="50" r="47" fill={`url(#bg${size})`} />
      <g clipPath={`url(#clip${size})`} stroke="#7A2400" strokeWidth="2" fill="none">
        <line x1="50" y1="3"  x2="50" y2="97" />
        <line x1="3"  y1="50" x2="97" y2="50" />
        <path d="M20 14 Q50 50 20 86" />
        <path d="M80 14 Q50 50 80 86" />
      </g>
      <circle cx="50" cy="50" r="47" fill={`url(#shine${size})`} />
      <circle cx="50" cy="50" r="47" stroke="rgba(0,0,0,.25)" strokeWidth="1.5" fill="none" />
    </svg>
  </div>
);

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Avatar Component
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const Avatar = ({ name, size = 38 }) => {
  const parts = (name || '?').trim().split(/\s+/);
  const initials = parts.length >= 2
    ? (parts[0][0] + parts[parts.length - 1][0]).toUpperCase()
    : parts[0][0].toUpperCase();
  const colors = [
    ['#F4631F','#B33A00'],['#FFB800','#CC8800'],['#FF6B6B','#C0392B'],
    ['#4ECDC4','#1A7A75'],['#95E1D3','#2D8C7A'],['#F38181','#C0392B'],
    ['#A8E6CF','#2E7D5B'],['#FFD93D','#CC9900'],
  ];
  const idx = name ? name.charCodeAt(0) % colors.length : 0;
  const [c1, c2] = colors[idx];
  return (
    <div style={{
      width: size, height: size, borderRadius: '50%',
      background: `radial-gradient(circle at 35% 35%, ${c1}, ${c2})`,
      display: 'flex', alignItems: 'center', justifyContent: 'center',
      flexShrink: 0,
      boxShadow: `0 2px 8px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.15)`,
      fontFamily: "'Anton', sans-serif",
      fontSize: size * 0.36 + 'px',
      color: '#fff',
      letterSpacing: '0.02em',
    }}>
      {initials}
    </div>
  );
};

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   DATA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const DAY_ORDER = [
  'thursday_r1','friday_r1','saturday_r2','sunday_r2',
  'thursday_s16','friday_s16','saturday_e8','sunday_e8',
  'saturday_ff','monday_champ'
];
const DAY_LABELS = {
  thursday_r1:'Thu R1', friday_r1:'Fri R1', saturday_r2:'Sat R2', sunday_r2:'Sun R2',
  thursday_s16:'Thu S16', friday_s16:'Fri S16', saturday_e8:'Sat E8', sunday_e8:'Sun E8',
  saturday_ff:'Sat FF', monday_champ:'Mon Champ'
};
const DAY_FULL = {
  thursday_r1:'Thursday â€” Round of 64', friday_r1:'Friday â€” Round of 64',
  saturday_r2:'Saturday â€” Round of 32', sunday_r2:'Sunday â€” Round of 32',
  thursday_s16:'Thursday â€” Sweet 16', friday_s16:'Friday â€” Sweet 16',
  saturday_e8:'Saturday â€” Elite 8', sunday_e8:'Sunday â€” Elite 8',
  saturday_ff:'Saturday â€” Final Four', monday_champ:'Monday â€” Championship'
};

const RULES_DATA = [
  {
    id:'r1', day:`Thursday R1`, color:'orange',
    heading:`Two Picks Required`,
    body:`Pick TWO winners on Thursday. Both must win outright. If either loses, you're eliminated â€” but you can buy back in for $25. If you buy back after Thursday, you must pick FOUR winners on Friday.`
  },
  {
    id:'r2', day:`Friday R1`, color:'orange',
    heading:`Two More Picks`,
    body:`If you survived Thursday, pick TWO more winners on Friday. If you lost Thursday and bought back in, you need FOUR winners Friday. Lose Friday and you can buy back in for Saturday â€” but you'll need THREE that day.`
  },
  {
    id:'r3', day:`Saturday R2`, color:'gold',
    heading:`One Pick (or Three on Buyback)`,
    body:`If you nailed Friday, pick just ONE winner Saturday. If you're buying back in after a Friday loss, pick THREE Saturday and go 3-for-3. Max buybacks is three and no buybacks after Sunday.`
  },
  {
    id:'r4', day:`Sunday R2`, color:'gold',
    heading:`One Pick (or Three on Buyback)`,
    body:`Same deal as Saturday. Survived Saturday? Pick one. Buying back in after a Saturday loss? Pick three â€” and go 3-for-3 to stay alive. This is your last chance to buy back in.`
  },
  {
    id:'r5', day:`Sweet 16 onward`, color:'orange',
    heading:`One Pick Per Day`,
    body:`From here on out you pick ONE winner per day. No more buybacks. Last person standing takes the pot. If multiple people survive, they can split or keep playing.`
  },
  {
    id:'r6', day:`All Rounds`, color:'gold',
    heading:`No Team Reuse`,
    body:`You cannot pick the same team twice â€” ever. Even if you buy back in, those previous picks are locked out. If you run out of eligible teams to pick, you automatically advance but lose that day (you still need to be beaten by someone who makes a successful pick).`
  },
];


/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   MAIN APP
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function App() {
  const [activeTab, setActiveTab] = useState('standings');

  // â”€â”€ Data from API â”€â”€
  const [loading, setLoading]       = useState(true);
  const [loadError, setLoadError]   = useState(null);
  const [siteLocked, setSiteLocked] = useState(false);
  const [lockMessage, setLockMessage] = useState('');
  const [config, setConfig]         = useState(null);
  const [players, setPlayers]       = useState([]);
  const [gamesData, setGamesData]   = useState({});

  // â”€â”€ Admin Auth State â”€â”€
  const [adminAuthed, setAdminAuthed] = useState(false);
  const [adminPassword, setAdminPassword] = useState('');
  const [showAdminLogin, setShowAdminLogin] = useState(false);
  const [adminLoginErr, setAdminLoginErr] = useState('');

  // â”€â”€ Submit Picks State â”€â”€
  const [pickerName,      setPickerName]      = useState('');
  const [teamPick1,       setTeamPick1]       = useState('');
  const [teamPick2,       setTeamPick2]       = useState('');
  const [submitted,       setSubmitted]       = useState(false);
  const [submitErr,       setSubmitErr]       = useState('');
  const [submitting,      setSubmitting]      = useState(false);

  // â”€â”€ Derived values from config â”€â”€
  const CURRENT_DAY = config?.currentDay || 'thursday_r1';
  const BUYBACK_DAYS = config?.buybackDays || [];
  const TEAMS = config?.teams || [];

  // â”€â”€ Fetch state from API â”€â”€
  const fetchState = async () => {
    try {
      const headers = adminAuthed ? { 'X-Admin-Password': adminPassword } : {};
      const resp = await fetch('/api/state', { headers });
      const data = await resp.json();
      if (data.siteLocked) {
        setSiteLocked(true);
        setLockMessage(data.lockMessage || 'Pool is under maintenance.');
        setLoading(false);
        return;
      }
      setSiteLocked(false);
      setConfig(data.config);
      setPlayers(data.players || []);
      setGamesData(data.games || {});
      setLoadError(null);
    } catch (err) {
      setLoadError('Could not connect to server. Please try again.');
    }
    setLoading(false);
  };

  // â”€â”€ Initial fetch + 30s auto-refresh â”€â”€
  useEffect(() => {
    fetchState();
    const interval = setInterval(fetchState, 30000);
    return () => clearInterval(interval);
  }, [adminAuthed, adminPassword]);


  // â”€â”€ Admin auth helper â”€â”€
  const adminHeaders = () => ({
    'Content-Type': 'application/json',
    'X-Admin-Password': adminPassword,
  });

  const handleAdminLogin = async () => {
    setAdminLoginErr('');
    try {
      const resp = await fetch('/api/admin/auth', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ password: adminPassword }),
      });
      if (resp.ok) {
        setAdminAuthed(true);
        setShowAdminLogin(false);
        setActiveTab('admin');
        fetchState();
      } else {
        setAdminLoginErr('Invalid password.');
      }
    } catch { setAdminLoginErr('Connection error.'); }
  };

  const handleAdminLogout = () => {
    setAdminAuthed(false);
    setAdminPassword('');
    setActiveTab('standings');
    fetchState();
  };

  const handleTabChange = useCallback((tab) => {
    setActiveTab(tab);
    setSubmitted(false);
    setSubmitErr('');
    setPickerName('');
    setTeamPick1('');
    setTeamPick2('');
  }, []);

  const handleSubmitPicks = async () => {
    setSubmitErr('');
    if (!pickerName.trim()) { setSubmitErr('Please enter your name.'); return; }
    if (!teamPick1) { setSubmitErr('Please select your first team.'); return; }
    if (!teamPick2) { setSubmitErr('Please select your second team.'); return; }
    if (teamPick1 === teamPick2) { setSubmitErr('You must pick two different teams.'); return; }

    // Find existing player by name
    const player = players.find(p => p.name.toLowerCase() === pickerName.trim().toLowerCase());
    if (!player) { setSubmitErr('Name not found. Contact the pool admin to be added.'); return; }

    setSubmitting(true);
    try {
      const picks = [teamPick1, teamPick2];
      const resp = await fetch('/api/picks', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ playerId: player.id, day: CURRENT_DAY, picks }),
      });
      const data = await resp.json();
      if (!resp.ok) {
        setSubmitErr(data.error || 'Failed to submit picks.');
      } else {
        setSubmitted(true);
        fetchState();
      }
    } catch {
      setSubmitErr('Connection error. Please try again.');
    }
    setSubmitting(false);
  };

  const TABS = [
    {id:'standings', label:'Standings'},
    {id:'scores',    label:'Scores'},
    {id:'picks',     label:'Submit Picks'},
    {id:'rules',     label:'Rules'},
    ...(adminAuthed ? [{id:'admin', label:'Admin'}] : []),
  ];

  const totalPot = players.reduce((s, p) => s + p.totalSpent, 0);
  const alivePlayers = useMemo(() => players.filter(p => p.status === 'alive'), [players]);
  const eliminatedPlayers = useMemo(() => players.filter(p => p.status === 'eliminated'), [players]);

  /* â”€â”€ Loading screen â”€â”€ */
  if (loading) {
    return (
      <div style={{minHeight:'100vh', background:'var(--bg)', display:'flex', alignItems:'center', justifyContent:'center'}}>
        <div style={{textAlign:'center'}}>
          <Basketball size={80} spin={true} glow={true} />
          <div className="anton" style={{fontSize:20, color:'var(--cream)', marginTop:20, letterSpacing:'0.04em'}}>
            LOADING POOL DATA...
          </div>
        </div>
      </div>
    );
  }

  /* â”€â”€ Error screen â”€â”€ */
  if (loadError) {
    return (
      <div style={{minHeight:'100vh', background:'var(--bg)', display:'flex', alignItems:'center', justifyContent:'center'}}>
        <div className="card" style={{maxWidth:440, padding:'40px 32px', textAlign:'center'}}>
          <div className="anton" style={{fontSize:24, color:'var(--danger)', marginTop:8}}>CONNECTION ERROR</div>
          <div style={{color:'var(--muted)', marginTop:12, lineHeight:1.6}}>{loadError}</div>
          <button className="btn btn-primary" style={{marginTop:20}} onClick={() => { setLoading(true); setLoadError(null); fetchState(); }}>
            Retry
          </button>
        </div>
      </div>
    );
  }

  /* â”€â”€ Site locked screen (non-admin) â”€â”€ */
  if (siteLocked && !adminAuthed) {
    return (
      <div style={{minHeight:'100vh', background:'var(--bg)', display:'flex', alignItems:'center', justifyContent:'center'}}>
        <div className="card" style={{maxWidth:440, padding:'40px 32px', textAlign:'center'}}>
          <Basketball size={72} bounce={true} glow={true} />
          <div className="anton" style={{fontSize:24, color:'var(--gold)', marginTop:20, letterSpacing:'0.04em'}}>
            POOL MAINTENANCE
          </div>
          <div style={{color:'var(--muted)', marginTop:12, lineHeight:1.6}}>{lockMessage}</div>
          <button className="btn btn-ghost" style={{marginTop:20}} onClick={() => setShowAdminLogin(true)}>
            Admin Login
          </button>
          {showAdminLogin && (
            <div style={{marginTop:16}}>
              <input className="form-input" type="password" placeholder="Admin password"
                     value={adminPassword} onChange={e => setAdminPassword(e.target.value)}
                     onKeyDown={e => e.key === 'Enter' && handleAdminLogin()}
                     style={{marginBottom:8}} />
              {adminLoginErr && <div style={{color:'var(--danger)', fontSize:13, marginBottom:8}}>{adminLoginErr}</div>}
              <button className="btn btn-primary" style={{width:'100%', justifyContent:'center'}} onClick={handleAdminLogin}>
                Login
              </button>
            </div>
          )}
        </div>
      </div>
    );
  }

  return (
    <div style={{minHeight:'100vh', background:'var(--bg)'}}>

      {/* Admin Login Modal */}
      {showAdminLogin && !adminAuthed && (
        <div style={{position:'fixed', inset:0, background:'rgba(0,0,0,.75)', display:'flex', alignItems:'center', justifyContent:'center', zIndex:1000, padding:16, backdropFilter:'blur(4px)'}}>
          <div className="card" style={{width:'100%', maxWidth:380}}>
            <div className="card-header">
              <div className="card-title">Admin Login</div>
              <button className="btn btn-ghost" style={{padding:'5px 10px'}} onClick={() => { setShowAdminLogin(false); setAdminLoginErr(''); }}>âœ•</button>
            </div>
            <div style={{padding:'20px 22px'}}>
              <label className="form-label">Password</label>
              <input className="form-input" type="password" placeholder="Enter admin password"
                     value={adminPassword} onChange={e => setAdminPassword(e.target.value)}
                     onKeyDown={e => e.key === 'Enter' && handleAdminLogin()} />
              {adminLoginErr && <div style={{color:'var(--danger)', fontSize:13, marginTop:8}}>{adminLoginErr}</div>}
              <button className="btn btn-primary" style={{width:'100%', justifyContent:'center', marginTop:14}} onClick={handleAdminLogin}>
                Login
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Venmo Bar */}
      <div className="venmo-bar">
        <a href="https://www.venmo.com/Ryan-Keefer-2" target="_blank" rel="noopener noreferrer"
           style={{color:'#fff', textDecoration:'none'}}>
          Pay Entry Fee via Venmo @Ryan-Keefer-2
        </a>
      </div>

      {/* Site locked banner for admin */}
      {config?.siteLocked && adminAuthed && (
        <div style={{background:'rgba(248,113,113,.15)', borderBottom:'1px solid rgba(248,113,113,.3)', padding:'6px 16px', textAlign:'center', fontSize:12, fontWeight:700, color:'var(--danger)', letterSpacing:'0.05em'}}>
          SITE IS LOCKED â€” Only you can see the pool right now
        </div>
      )}

      {/* Header */}
      <header className="site-header">
        <div className="header-flame" />
        <div style={{maxWidth:1100, margin:'0 auto', padding:'0 16px', position:'relative'}}>
          <div style={{display:'flex', alignItems:'center', justifyContent:'space-between', padding:'16px 0 0'}}>
            <div style={{display:'flex', alignItems:'center', gap:16}}>
              <Basketball size={44} spin={true} glow={true} />
              <div>
                <div className="anton" style={{fontSize:22, color:'var(--cream)', lineHeight:1.1, letterSpacing:'0.04em'}}>
                  MARCH MADNESS
                </div>
                <div className="mono" style={{fontSize:11, color:'var(--accent)', letterSpacing:'0.12em', marginTop:1}}>
                  KNOCKOUT POOL â€” 2025
                </div>
              </div>
            </div>
            <div style={{display:'flex', alignItems:'center', gap:14}}>
              <div style={{textAlign:'right'}}>
                <div className="mono" style={{fontSize:26, color:'var(--gold)', fontWeight:700, lineHeight:1}}>
                  ${totalPot.toLocaleString()}
                </div>
                <div style={{fontSize:10, color:'var(--muted)', letterSpacing:'0.06em', textTransform:'uppercase', marginTop:4}}>Total Pot</div>
              </div>
              {adminAuthed ? (
                <button onClick={handleAdminLogout}
                        title="Logout admin"
                        style={{ background:'none', border:'none', cursor:'pointer', padding:4, color:'var(--danger)', fontSize:18, lineHeight:1, opacity:0.7, transition:'opacity .2s' }}
                        onMouseOver={e => e.currentTarget.style.opacity = 1}
                        onMouseOut={e => e.currentTarget.style.opacity = 0.7}>
                  ðŸ”“
                </button>
              ) : (
                <button onClick={() => setShowAdminLogin(true)}
                        title="Admin login"
                        style={{ background:'none', border:'none', cursor:'pointer', padding:4, color:'var(--muted)', fontSize:18, lineHeight:1, opacity:0.7, transition:'opacity .2s' }}
                        onMouseOver={e => e.currentTarget.style.opacity = 1}
                        onMouseOut={e => e.currentTarget.style.opacity = 0.7}>
                  ðŸ”’
                </button>
              )}
            </div>
          </div>

          {/* Nav */}
          <div style={{display:'flex', gap:0, overflowX:'auto', marginTop:4}}>
            {TABS.map(tab => (
              <div key={tab.id} className={`nav-tab ${activeTab === tab.id ? 'active' : ''}`}
                   onClick={() => handleTabChange(tab.id)}>
                {tab.label}
              </div>
            ))}
          </div>
        </div>
      </header>


      {/* Main Content */}
      <main style={{maxWidth:1100, margin:'0 auto', padding:'28px 16px 60px'}}>

        {/* â”€â”€ STANDINGS â”€â”€ */}
        {activeTab === 'standings' && (
          <div className="anim-up">
            {/* Stats Row */}
            <div style={{display:'grid', gridTemplateColumns:'repeat(auto-fit, minmax(160px,1fr))', gap:14, marginBottom:28}}>
              <div className="stat-card green anim-up anim-up-1">
                <div className="mono" style={{fontSize:28, fontWeight:700, color:'var(--success)', lineHeight:1}}>{alivePlayers.length}</div>
                <div style={{fontSize:11, color:'var(--muted)', marginTop:6, letterSpacing:'0.08em', textTransform:'uppercase'}}>Still Alive</div>
              </div>
              <div className="stat-card red anim-up anim-up-2">
                <div className="mono" style={{fontSize:28, fontWeight:700, color:'#f87171', lineHeight:1}}>{eliminatedPlayers.length}</div>
                <div style={{fontSize:11, color:'var(--muted)', marginTop:6, letterSpacing:'0.08em', textTransform:'uppercase'}}>Eliminated</div>
              </div>
              <div className="stat-card white anim-up anim-up-3">
                <div className="mono" style={{fontSize:28, fontWeight:700, color:'#e5e7eb', lineHeight:1}}>{DAY_LABELS[CURRENT_DAY]}</div>
                <div style={{fontSize:11, color:'var(--muted)', marginTop:6, letterSpacing:'0.08em', textTransform:'uppercase'}}>Current Round</div>
              </div>
            </div>

            {/* Entries */}
            {/* Still In It */}
            <div className="card anim-up anim-up-2" style={{marginBottom:20}}>
              <div className="card-header">
                <div className="card-title" style={{color:'var(--success)'}}>Still In It</div>
                <span className="badge badge-alive">{alivePlayers.length}</span>
              </div>
              {alivePlayers.length === 0 ? (
                <div style={{padding:'24px 22px', textAlign:'center', color:'var(--muted)', fontSize:13}}>
                  No players alive yet. Submit your picks to join!
                </div>
              ) : (
                [...alivePlayers].sort((a,b) => a.name.localeCompare(b.name)).map((p, i) => (
                  <div key={p.id} className="player-row" style={{animationDelay: `${(i+3)*60}ms`}}>
                    <Avatar name={p.name} size={34} />
                    <div style={{flex:1}}>
                      <div style={{display:'flex', alignItems:'center', gap:8}}>
                        <span style={{fontWeight:700, color:'var(--cream)', fontSize:15}}>{p.name}</span>
                        <span className="badge badge-alive" style={{fontSize:9}}>ALIVE</span>
                        {p.buybacks > 0 && <span className="badge badge-buyback" style={{fontSize:9}}>{p.buybacks}x BB</span>}
                      </div>
                      <div style={{fontSize:12, color:'var(--muted)', marginTop:1}}>${p.totalSpent} spent</div>
                    </div>
                    <div style={{display:'flex', flexWrap:'wrap', gap:4, justifyContent:'flex-end'}}>
                      {Object.entries(p.picks).map(([day, picks]) =>
                        picks.map(t => {
                          const result = p.results[day];
                          const cls = result === 'win' ? 'badge-win' : result === 'loss' ? 'badge-loss' : 'badge-pending';
                          return <span key={`${day}-${t}`} className={`badge ${cls}`} style={{fontSize:10}}>{t}</span>;
                        })
                      )}
                    </div>
                  </div>
                ))
              )}
            </div>

            {/* Eliminated */}
            {eliminatedPlayers.length > 0 && (
              <div className="card anim-up anim-up-3" style={{marginBottom:20}}>
                <div className="card-header">
                  <div className="card-title" style={{color:'var(--danger)'}}>Eliminated</div>
                  <span className="badge badge-out">{eliminatedPlayers.length}</span>
                </div>
                {[...eliminatedPlayers].sort((a,b) => a.name.localeCompare(b.name)).map((p, i) => (
                  <div key={p.id} className="player-row" style={{animationDelay: `${(i+3)*60}ms`, opacity:0.7}}>
                    <Avatar name={p.name} size={34} />
                    <div style={{flex:1}}>
                      <div style={{display:'flex', alignItems:'center', gap:8}}>
                        <span style={{fontWeight:700, color:'var(--cream)', fontSize:15}}>{p.name}</span>
                        <span className="badge badge-out" style={{fontSize:9}}>OUT</span>
                        {p.needsBuyback && <span className="badge badge-buyback" style={{fontSize:9}}>CAN BUY BACK</span>}
                      </div>
                      <div style={{fontSize:12, color:'var(--muted)', marginTop:1}}>${p.totalSpent} spent</div>
                    </div>
                    <div style={{display:'flex', flexWrap:'wrap', gap:4, justifyContent:'flex-end'}}>
                      {Object.entries(p.picks).map(([day, picks]) =>
                        picks.map(t => {
                          const result = p.results[day];
                          const cls = result === 'win' ? 'badge-win' : result === 'loss' ? 'badge-loss' : 'badge-pending';
                          return <span key={`${day}-${t}`} className={`badge ${cls}`} style={{fontSize:10}}>{t}</span>;
                        })
                      )}
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        )}

        {/* â”€â”€ SCORES â”€â”€ */}
        {activeTab === 'scores' && (
          <div className="anim-up">
            {Object.keys(gamesData).length === 0 ? (
              <div className="card" style={{padding:'40px 22px', textAlign:'center'}}>
                <Basketball size={48} bounce={true} glow={true} />
                <div className="anton" style={{fontSize:20, color:'var(--cream)', marginTop:16, letterSpacing:'0.04em'}}>
                  NO GAMES YET
                </div>
                <div style={{color:'var(--muted)', marginTop:8, fontSize:14}}>
                  Games will appear here once Thursday's Round of 64 tips off.
                </div>
              </div>
            ) : (
              Object.entries(gamesData).map(([day, games]) => (
                <div key={day} style={{marginBottom:24}}>
                  <div style={{display:'flex', alignItems:'center', gap:10, marginBottom:12}}>
                    <div className="anton" style={{fontSize:16, color:'var(--cream)', letterSpacing:'0.05em'}}>{DAY_FULL[day]}</div>
                    {day === CURRENT_DAY && (() => {
                      const allFinal = games.every(g => g.final);
                      return allFinal
                        ? <span className="badge badge-win" style={{fontSize:10}}>Final</span>
                        : <span className="badge badge-pending" style={{animation:'glow-pulse 1.5s ease-in-out infinite'}}>Live</span>;
                    })()}
                  </div>
                  <div className="card">
                    {games.map((game, idx) => (
                      <div key={game.id} className="game-row">
                        <div style={{display:'flex', alignItems:'center', gap:10}}>
                          <div style={{flex:1}}>
                            <div style={{display:'flex', alignItems:'center', gap:8}}>
                              <span style={{
                                fontWeight: game.winner === game.home ? 700 : 400,
                                color: game.winner === game.home ? 'var(--cream)' : 'var(--muted)',
                                fontSize: 14,
                              }}>{game.home}</span>
                              {game.final && game.winner === game.home && (
                                <span className="badge badge-win" style={{fontSize:9}}>W</span>
                              )}
                            </div>
                            <div style={{display:'flex', alignItems:'center', gap:8, marginTop:4}}>
                              <span style={{
                                fontWeight: game.winner === game.away ? 700 : 400,
                                color: game.winner === game.away ? 'var(--cream)' : 'var(--muted)',
                                fontSize: 14,
                              }}>{game.away}</span>
                              {game.final && game.winner === game.away && (
                                <span className="badge badge-win" style={{fontSize:9}}>W</span>
                              )}
                            </div>
                          </div>
                          <div style={{textAlign:'right', minWidth:80}}>
                            {game.final ? (
                              <div>
                                <div className="mono" style={{fontSize:15, fontWeight:700, color:'var(--text)'}}>{game.homeScore}</div>
                                <div className="mono" style={{fontSize:15, fontWeight:700, color:'var(--text)', marginTop:4}}>{game.awayScore}</div>
                              </div>
                            ) : (
                              <span className="badge badge-pending" style={{fontSize:10}}>
                                {game.homeScore !== null ? `${game.homeScore}-${game.awayScore}` : 'TBD'}
                              </span>
                            )}
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              ))
            )}
          </div>
        )}

        {/* â”€â”€ SUBMIT PICKS â”€â”€ */}
        {activeTab === 'picks' && (
          <div className="anim-up" style={{maxWidth:560}}>
            {submitted ? (
              <div className="card" style={{padding:'40px 32px', textAlign:'center'}}>
                <Basketball size={72} bounce={true} glow={true} className="" />
                <div className="anton" style={{fontSize:28, color:'var(--success)', marginTop:20, letterSpacing:'0.04em'}}>
                  PICKS LOCKED IN
                </div>
                <div style={{color:'var(--muted)', marginTop:8}}>
                  {pickerName} â€” Thursday R1
                </div>
                <div style={{fontSize:13, color:'var(--accent)', marginTop:6}}>
                  $25 entry fee added to pot
                </div>
                <div style={{marginTop:16, display:'flex', flexWrap:'wrap', gap:8, justifyContent:'center'}}>
                  <span className="badge badge-pending" style={{fontSize:13, padding:'5px 14px'}}>{teamPick1}</span>
                  <span className="badge badge-pending" style={{fontSize:13, padding:'5px 14px'}}>{teamPick2}</span>
                </div>
                <div style={{display:'flex', gap:10, marginTop:24, justifyContent:'center'}}>
                  <button className="btn btn-ghost"
                          onClick={() => { setSubmitted(false); setTeamPick1(''); setTeamPick2(''); setPickerName(''); }}>
                    Submit Another Entry
                  </button>
                  <button className="btn btn-primary" onClick={() => { handleTabChange('standings'); }}>
                    View Standings
                  </button>
                </div>
              </div>
            ) : (
              <div>
                <div style={{
                  background:'rgba(244,99,31,.08)', border:'1px solid rgba(244,99,31,.25)',
                  borderRadius:10, padding:'14px 18px', marginBottom:14,
                  display:'flex', alignItems:'center', gap:12
                }}>
                  <Basketball size={28} />
                  <div>
                    <div style={{fontWeight:700, color:'var(--accent)', fontSize:13, letterSpacing:'0.05em', textTransform:'uppercase'}}>Thursday â€” Round of 64</div>
                    <div style={{fontSize:12, color:'var(--muted)', marginTop:2}}>Pick TWO winners. Both must win outright. Entry fee: $25.</div>
                  </div>
                </div>

                <div className="card" style={{padding:'24px 26px', marginBottom:20}}>
                  <div className="anton" style={{fontSize:18, color:'var(--cream)', letterSpacing:'0.05em', marginBottom:18}}>
                    SUBMIT YOUR PICKS
                  </div>

                  <div style={{marginBottom:16}}>
                    <label className="form-label">Your Name</label>
                    <input className="form-input" placeholder="Enter your name"
                           value={pickerName} onChange={e => setPickerName(e.target.value)} />
                  </div>

                  <div style={{marginBottom:14}}>
                    <label className="form-label">Pick 1</label>
                    <select className="form-select" value={teamPick1} onChange={e => setTeamPick1(e.target.value)}>
                      <option value="">Select team...</option>
                      {TEAMS.filter(t => t !== teamPick2).map(t => <option key={t} value={t}>{t}</option>)}
                    </select>
                  </div>

                  <div style={{marginBottom:14}}>
                    <label className="form-label">Pick 2</label>
                    <select className="form-select" value={teamPick2} onChange={e => setTeamPick2(e.target.value)}>
                      <option value="">Select team...</option>
                      {TEAMS.filter(t => t !== teamPick1).map(t => <option key={t} value={t}>{t}</option>)}
                    </select>
                  </div>

                  {submitErr && (
                    <div style={{color:'var(--danger)', fontSize:13, marginBottom:12, padding:'10px 14px',
                                 background:'rgba(248,113,113,.08)', border:'1px solid rgba(248,113,113,.2)', borderRadius:8}}>
                      {submitErr}
                    </div>
                  )}

                  <button className="btn btn-primary" style={{width:'100%', justifyContent:'center', marginTop:8, opacity: submitting ? 0.6 : 1}}
                          onClick={handleSubmitPicks} disabled={submitting}>
                    {submitting ? 'Submitting...' : 'Lock In Picks'}
                  </button>
                </div>

              </div>
            )}
          </div>
        )}

        {/* â”€â”€ RULES â”€â”€ */}
        {activeTab === 'rules' && (
          <div className="anim-up">
            {/* Big heading with basketball */}
            <div style={{display:'flex', alignItems:'flex-end', gap:20, marginBottom:32}}>
              <div>
                <div className="anton" style={{fontSize:42, color:'var(--cream)', lineHeight:1, letterSpacing:'0.03em'}}>
                  HOW TO PLAY
                </div>
                <div style={{color:'var(--muted)', fontSize:14, marginTop:6, maxWidth:500, lineHeight:1.6}}>
                  Last person standing wins it all. Simple in theory, brutal in practice.
                </div>
              </div>
              <Basketball size={80} bounce={true} glow={true} />
            </div>

            <div style={{display:'grid', gap:14}}>
              {RULES_DATA.map((rule, i) => (
                <div key={rule.id} className={`rule-card ${rule.color} anim-up`} style={{animationDelay: `${i*60}ms`}}>
                  <div style={{display:'flex', alignItems:'center', gap:10, marginBottom:8}}>
                    <span className="badge badge-pending" style={{fontSize:10}}>{rule.day}</span>
                    <div className="anton" style={{fontSize:14, color:'var(--cream)', letterSpacing:'0.05em'}}>
                      {rule.heading}
                    </div>
                  </div>
                  <div style={{color:'var(--muted)', fontSize:14, lineHeight:1.65}}>{rule.body}</div>
                </div>
              ))}
            </div>

            <div style={{
              marginTop:28, padding:'20px 24px',
              background:'rgba(255,184,0,.06)', border:'1px solid rgba(255,184,0,.2)', borderRadius:10
            }}>
              <div className="anton" style={{fontSize:14, color:'var(--gold)', letterSpacing:'0.08em', marginBottom:8}}>
                ENTRY FEE & BUYBACKS
              </div>
              <div style={{color:'var(--muted)', fontSize:14, lineHeight:1.65, marginBottom:14}}>
                Entry is $25. Each buyback costs another $25. Max three buybacks total, no buybacks after Sunday R2.
                Winner takes the entire pot. Multiple survivors can split or keep playing.
              </div>
              <a href="https://www.venmo.com/Ryan-Keefer-2" target="_blank" rel="noopener noreferrer">
                <button className="btn btn-gold">Pay via Venmo</button>
              </a>
            </div>
          </div>
        )}


        {/* â”€â”€ ADMIN â”€â”€ */}
        {activeTab === 'admin' && adminAuthed && (
          <div className="anim-up">
            <div className="anton" style={{fontSize:28, color:'var(--cream)', marginBottom:20, letterSpacing:'0.04em'}}>
              ADMIN PANEL
            </div>

            {/* Lock / Unlock Site */}
            <div className="card" style={{marginBottom:20}}>
              <div className="card-header">
                <div className="card-title">Site Lock</div>
                <span className={`badge ${config?.siteLocked ? 'badge-loss' : 'badge-win'}`}>
                  {config?.siteLocked ? 'LOCKED' : 'UNLOCKED'}
                </span>
              </div>
              <div style={{padding:'16px 22px'}}>
                <button className="btn btn-primary" onClick={async () => {
                  await fetch('/api/admin/config', {
                    method: 'POST',
                    headers: adminHeaders(),
                    body: JSON.stringify({ siteLocked: !config?.siteLocked }),
                  });
                  fetchState();
                }}>
                  {config?.siteLocked ? 'Unlock Site' : 'Lock Site'}
                </button>
              </div>
            </div>

            {/* Process Day */}
            <div className="card" style={{marginBottom:20}}>
              <div className="card-header">
                <div className="card-title">Process Day Results</div>
                <span className="badge badge-pending">{DAY_LABELS[CURRENT_DAY]}</span>
              </div>
              <div style={{padding:'16px 22px'}}>
                <div style={{color:'var(--muted)', fontSize:13, marginBottom:12}}>
                  Evaluate all picks for the current day against game results. This will update player statuses and advance to the next day.
                </div>
                <button className="btn btn-primary" onClick={async () => {
                  const resp = await fetch('/api/admin/process-day', {
                    method: 'POST',
                    headers: adminHeaders(),
                    body: JSON.stringify({ day: CURRENT_DAY }),
                  });
                  const data = await resp.json();
                  if (data.ok) {
                    alert('Day processed! New day: ' + (data.currentDay || 'done'));
                  } else {
                    alert('Error: ' + (data.error || 'Unknown'));
                  }
                  fetchState();
                }}>
                  Process {DAY_LABELS[CURRENT_DAY]}
                </button>
              </div>
            </div>

            {/* Player List */}
            <div className="card" style={{marginBottom:20}}>
              <div className="card-header">
                <div className="card-title">Players ({players.length})</div>
              </div>
              <div style={{overflowX:'auto'}}>
                <table className="admin-table">
                  <thead>
                    <tr>
                      <th>ID</th><th>Name</th><th>Status</th><th>Buybacks</th><th>Spent</th>
                    </tr>
                  </thead>
                  <tbody>
                    {players.map(p => (
                      <tr key={p.id}>
                        <td>{p.id}</td>
                        <td>{p.name}</td>
                        <td><span className={`badge badge-${p.status === 'alive' ? 'alive' : 'out'}`} style={{fontSize:10}}>{p.status}</span></td>
                        <td>{p.buybacks}</td>
                        <td>${p.totalSpent}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>

          </div>
        )}

      </main>

    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
