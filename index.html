<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>March Madness Knockout Pool 2025</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Anton&family=Karla:wght@300;400;500;600;700&family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg:      #080808;
      --surface: #111111;
      --raised:  #1a1a1a;
      --float:   #222222;
      --border:  rgba(255,255,255,0.08);
      --accent:  #F4631F;
      --gold:    #FFB800;
      --cream:   #F2E8D9;
      --text:    #F2E8D9;
      --muted:   #8a7a6a;
      --dim:     #4a3a2a;
      --success: #4ade80;
      --danger:  #f87171;
      --warn:    #FFB800;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Karla', system-ui, sans-serif;
      font-size: 15px;
      line-height: 1.7;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .anton { font-family: 'Anton', sans-serif; letter-spacing: 0.02em; }
    .mono { font-family: 'Courier Prime', monospace; }

    ::-webkit-scrollbar { width: 4px; height: 4px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--dim); border-radius: 2px; }

    @keyframes fadeUp {
      from { opacity:0; transform:translateY(16px); }
      to   { opacity:1; transform:translateY(0); }
    }
    @keyframes bounce-ball {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      30%       { transform: translateY(-22px) rotate(-15deg); }
      60%       { transform: translateY(0) rotate(5deg); }
      80%       { transform: translateY(-8px) rotate(-5deg); }
    }
    @keyframes spin-ball {
      0%   { transform: rotate(0deg) scale(1); }
      25%  { transform: rotate(90deg) scale(1.06); }
      50%  { transform: rotate(180deg) scale(1); }
      75%  { transform: rotate(270deg) scale(1.06); }
      100% { transform: rotate(360deg) scale(1); }
    }
    @keyframes glow-pulse {
      0%, 100% { opacity: .6; }
      50%       { opacity: 1; }
    }
    @keyframes shimmer {
      0%   { background-position: -200% 0; }
      100% { background-position:  200% 0; }
    }
    .anim-up   { animation: fadeUp .45s cubic-bezier(.22,1,.36,1) both; }
    .anim-up-1 { animation-delay:  60ms; }
    .anim-up-2 { animation-delay: 120ms; }
    .anim-up-3 { animation-delay: 180ms; }
    .anim-up-4 { animation-delay: 240ms; }
    .anim-up-5 { animation-delay: 300ms; }
    .anim-up-6 { animation-delay: 360ms; }
    .anim-up-7 { animation-delay: 420ms; }

    /* ‚îÄ‚îÄ Court texture ‚îÄ‚îÄ */
    .court-texture {
      background-color: var(--bg);
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 59px, rgba(255,255,255,.03) 59px, rgba(255,255,255,.03) 60px),
        repeating-linear-gradient(90deg, transparent, transparent 59px, rgba(255,255,255,.03) 59px, rgba(255,255,255,.03) 60px);
    }

    /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
    .site-header {
      position: sticky; top: 0; z-index: 50;
      background: rgba(8,8,8,.95);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--border);
      overflow: hidden;
    }
    .header-flame {
      position: absolute; inset: 0; pointer-events: none;
      background: radial-gradient(ellipse 70% 200% at 80% 50%, rgba(244,99,31,.14) 0%, transparent 65%);
    }

    /* ‚îÄ‚îÄ Nav ‚îÄ‚îÄ */
    .nav-tab {
      display:flex; align-items:center; gap:7px;
      padding: 14px 20px; font-size: 13px; font-weight: 600;
      letter-spacing: 0.06em; text-transform: uppercase;
      color: var(--muted); cursor: pointer; white-space: nowrap;
      border-bottom: 2px solid transparent;
      transition: color .2s, border-color .2s;
    }
    .nav-tab:hover { color: var(--cream); }
    .nav-tab.active { color: var(--accent); border-bottom-color: var(--accent); }

    /* ‚îÄ‚îÄ Cards ‚îÄ‚îÄ */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }
    .card-header {
      padding: 18px 22px 16px;
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
    }
    .card-title {
      font-family: 'Anton', sans-serif;
      font-size: 15px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--cream);
    }

    /* ‚îÄ‚îÄ Badges ‚îÄ‚îÄ */
    .badge {
      display: inline-flex; align-items: center; gap: 4px;
      padding: 3px 10px; border-radius: 4px;
      font-size: 11px; font-weight: 700;
      letter-spacing: 0.08em; text-transform: uppercase;
    }
    .badge-alive   { background: rgba(74,222,128,.12); color: var(--success); border: 1px solid rgba(74,222,128,.25); }
    .badge-out     { background: rgba(248,113,113,.1); color: var(--danger);  border: 1px solid rgba(248,113,113,.2); }
    .badge-buyback { background: rgba(255,184,0,.12);  color: var(--gold);    border: 1px solid rgba(255,184,0,.25); }
    .badge-win     { background: rgba(74,222,128,.12); color: var(--success); border: 1px solid rgba(74,222,128,.25); }
    .badge-loss    { background: rgba(248,113,113,.1); color: var(--danger);  border: 1px solid rgba(248,113,113,.2); }
    .badge-pending { background: rgba(255,184,0,.1);  color: var(--gold);    border: 1px solid rgba(255,184,0,.2);  }

    /* ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ */
    .btn {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 10px 22px; border-radius: 8px; border: none; cursor: pointer;
      font-family: 'Karla', sans-serif; font-size: 14px; font-weight: 700;
      letter-spacing: 0.04em;
      transition: transform .15s, box-shadow .15s, opacity .15s;
    }
    .btn:hover   { transform: translateY(-1px); }
    .btn:active  { transform: translateY(0); }
    .btn:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
    .btn-primary {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 4px 20px rgba(244,99,31,.4), 0 1px 3px rgba(0,0,0,.5);
    }
    .btn-primary:hover {
      box-shadow: 0 6px 28px rgba(244,99,31,.55), 0 2px 6px rgba(0,0,0,.5);
    }
    .btn-gold {
      background: var(--gold);
      color: #111;
      box-shadow: 0 4px 20px rgba(255,184,0,.35), 0 1px 3px rgba(0,0,0,.5);
    }
    .btn-ghost {
      background: transparent;
      color: var(--muted);
      border: 1px solid var(--border);
    }
    .btn-ghost:hover { color: var(--text); border-color: rgba(255,255,255,.2); }

    /* ‚îÄ‚îÄ Game rows ‚îÄ‚îÄ */
    .game-row {
      padding: 14px 22px;
      border-bottom: 1px solid var(--border);
      transition: background .15s;
    }
    .game-row:last-child { border-bottom: none; }
    .game-row:hover { background: rgba(255,255,255,.025); }

    /* ‚îÄ‚îÄ Player rows ‚îÄ‚îÄ */
    .player-row {
      padding: 14px 22px;
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; gap: 14px;
      transition: background .15s;
    }
    .player-row:last-child { border-bottom: none; }
    .player-row:hover { background: rgba(255,255,255,.025); }

    /* ‚îÄ‚îÄ Form ‚îÄ‚îÄ */
    .form-label {
      display: block;
      font-size: 11px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase;
      color: var(--muted); margin-bottom: 6px;
    }
    .form-input, .form-select {
      width: 100%; padding: 11px 14px;
      background: var(--raised); border: 1px solid var(--border);
      border-radius: 8px; color: var(--text);
      font-family: 'Karla', sans-serif; font-size: 14px;
      transition: border-color .2s, box-shadow .2s;
    }
    .form-input:focus, .form-select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(244,99,31,.15);
    }
    .form-input::placeholder { color: var(--muted); }
    .form-select option { background: var(--raised); }

    /* ‚îÄ‚îÄ Admin table ‚îÄ‚îÄ */
    .admin-table { width: 100%; border-collapse: collapse; }
    .admin-table th {
      padding: 10px 14px; text-align: left;
      font-size: 11px; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase;
      color: var(--muted); border-bottom: 1px solid var(--border);
    }
    .admin-table td {
      padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,.04);
      font-size: 13.5px; vertical-align: middle;
    }
    .admin-table tr:hover td { background: rgba(255,255,255,.025); }

    /* ‚îÄ‚îÄ Venmo banner ‚îÄ‚îÄ */
    .venmo-bar {
      background: linear-gradient(135deg, #008CFF 0%, #00B3FF 100%);
      padding: 3px 0; text-align: center;
      font-size: 12px; font-weight: 700; letter-spacing: 0.05em;
      color: #fff;
    }

    /* ‚îÄ‚îÄ Scoreboard ‚îÄ‚îÄ */
    .score-pill {
      font-family: 'Courier Prime', monospace;
      font-size: 13px; font-weight: 700;
      min-width: 26px; text-align: center;
      padding: 2px 8px;
      background: var(--raised); border-radius: 4px;
      border: 1px solid var(--border);
    }

    /* ‚îÄ‚îÄ Rules ‚îÄ‚îÄ */
    .rule-card {
      background: var(--raised);
      border-left: 3px solid var(--accent);
      border-radius: 0 8px 8px 0;
      padding: 14px 18px;
    }
    .rule-card.gold { border-left-color: var(--gold); }

    /* ‚îÄ‚îÄ Toggle ‚îÄ‚îÄ */
    .toggle-pill {
      display: inline-flex;
      background: var(--raised);
      border: 1px solid var(--border);
      border-radius: 100px;
      padding: 3px;
    }
    .toggle-opt {
      padding: 6px 16px; border-radius: 100px; cursor: pointer;
      font-size: 12px; font-weight: 700; letter-spacing: 0.05em; text-transform: uppercase;
      color: var(--muted); transition: all .2s;
    }
    .toggle-opt.active { background: var(--accent); color: #fff; }

    /* ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ */
    .subtab {
      padding: 8px 16px; border-radius: 6px; cursor: pointer;
      font-size: 12px; font-weight: 700; letter-spacing: 0.05em; text-transform: uppercase;
      color: var(--muted); transition: all .2s;
    }
    .subtab.active { background: var(--raised); color: var(--text); }
    .subtab:hover:not(.active) { color: var(--cream); }

    /* ‚îÄ‚îÄ Divider ‚îÄ‚îÄ */
    .divider { border: none; border-top: 1px solid var(--border); }

    /* ‚îÄ‚îÄ Pool stat cards ‚îÄ‚îÄ */
    .stat-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px 22px;
      position: relative; overflow: hidden;
    }
    .stat-card::before {
      content:''; position:absolute; top:0; left:0; right:0; height:2px;
    }
    .stat-card.orange::before { background: var(--accent); }
    .stat-card.gold::before   { background: var(--gold); }
    .stat-card.green::before  { background: var(--success); }
    .stat-card.red::before    { background: #ef4444; }
    .stat-card.blue::before   { background: #3b82f6; }
    .stat-card.white::before  { background: #e5e7eb; }
  </style>
</head>
<body class="court-texture">

<div id="root"></div>

<script type="text/babel">
const { useState, useMemo, useCallback, useEffect } = React;

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   SVG Basketball Component
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const Basketball = ({ size = 60, bounce = false, spin = false, className = '', glow = false }) => (
  <div
    className={className}
    style={{
      width: size, height: size, flexShrink: 0,
      animation: spin
        ? 'spin-ball 2.4s cubic-bezier(.4,0,.6,1) infinite'
        : bounce ? 'bounce-ball 1.8s cubic-bezier(.36,.07,.19,.97) infinite' : 'none',
      filter: glow ? `drop-shadow(0 0 ${size * 0.18}px rgba(244,99,31,.75)) drop-shadow(0 0 ${size * 0.35}px rgba(244,99,31,.3))` : 'none',
    }}
  >
    <svg viewBox="0 0 100 100" width={size} height={size}>
      <defs>
        <radialGradient id={`bg${size}`} cx="38%" cy="32%">
          <stop offset="0%"   stopColor="#FF8C42" />
          <stop offset="45%"  stopColor="#F4631F" />
          <stop offset="100%" stopColor="#B33A00" />
        </radialGradient>
        <radialGradient id={`shine${size}`} cx="32%" cy="28%">
          <stop offset="0%"   stopColor="rgba(255,255,255,.35)" />
          <stop offset="100%" stopColor="rgba(255,255,255,0)" />
        </radialGradient>
        <clipPath id={`clip${size}`}>
          <circle cx="50" cy="50" r="47" />
        </clipPath>
      </defs>
      <circle cx="50" cy="50" r="47" fill={`url(#bg${size})`} />
      <g clipPath={`url(#clip${size})`} stroke="#7A2400" strokeWidth="2" fill="none">
        <line x1="50" y1="3"  x2="50" y2="97" />
        <line x1="3"  y1="50" x2="97" y2="50" />
        <path d="M20 14 Q50 50 20 86" />
        <path d="M80 14 Q50 50 80 86" />
      </g>
      <circle cx="50" cy="50" r="47" fill={`url(#shine${size})`} />
      <circle cx="50" cy="50" r="47" stroke="rgba(0,0,0,.25)" strokeWidth="1.5" fill="none" />
    </svg>
  </div>
);

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   Avatar Component
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const Avatar = ({ name, size = 38 }) => {
  const parts = (name || '?').trim().split(/\s+/);
  const initials = parts.length >= 2
    ? (parts[0][0] + parts[parts.length - 1][0]).toUpperCase()
    : parts[0][0].toUpperCase();
  const colors = [
    ['#F4631F','#B33A00'],['#FFB800','#CC8800'],['#FF6B6B','#C0392B'],
    ['#4ECDC4','#1A7A75'],['#95E1D3','#2D8C7A'],['#F38181','#C0392B'],
    ['#A8E6CF','#2E7D5B'],['#FFD93D','#CC9900'],
  ];
  const idx = name ? name.charCodeAt(0) % colors.length : 0;
  const [c1, c2] = colors[idx];
  return (
    <div style={{
      width: size, height: size, borderRadius: '50%',
      background: `radial-gradient(circle at 35% 35%, ${c1}, ${c2})`,
      display: 'flex', alignItems: 'center', justifyContent: 'center',
      flexShrink: 0,
      boxShadow: `0 2px 8px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.15)`,
      fontFamily: "'Anton', sans-serif",
      fontSize: size * 0.36 + 'px',
      color: '#fff',
      letterSpacing: '0.02em',
    }}>
      {initials}
    </div>
  );
};

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   DATA
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const DAY_ORDER = [
  'thursday_r1','friday_r1','saturday_r2','sunday_r2',
  'thursday_s16','friday_s16','saturday_e8','sunday_e8',
  'saturday_ff','monday_champ'
];
const DAY_LABELS = {
  thursday_r1:'Thu R1', friday_r1:'Fri R1', saturday_r2:'Sat R2', sunday_r2:'Sun R2',
  thursday_s16:'Thu S16', friday_s16:'Fri S16', saturday_e8:'Sat E8', sunday_e8:'Sun E8',
  saturday_ff:'Sat FF', monday_champ:'Mon Champ'
};
const DAY_FULL = {
  thursday_r1:'Thursday ‚Äî Round of 64', friday_r1:'Friday ‚Äî Round of 64',
  saturday_r2:'Saturday ‚Äî Round of 32', sunday_r2:'Sunday ‚Äî Round of 32',
  thursday_s16:'Thursday ‚Äî Sweet 16', friday_s16:'Friday ‚Äî Sweet 16',
  saturday_e8:'Saturday ‚Äî Elite 8', sunday_e8:'Sunday ‚Äî Elite 8',
  saturday_ff:'Saturday ‚Äî Final Four', monday_champ:'Monday ‚Äî Championship'
};

const RULES_DATA = [
  {
    id:'r1', day:`Thursday R1`, color:'orange',
    heading:`Two Picks Required`,
    body:`Pick TWO winners on Thursday. Both must win outright. If either loses, you're eliminated ‚Äî but you can buy back in for $25. If you buy back after Thursday, you must pick FOUR winners on Friday.`
  },
  {
    id:'r2', day:`Friday R1`, color:'orange',
    heading:`Two More Picks`,
    body:`If you survived Thursday, pick TWO more winners on Friday. If you lost Thursday and bought back in, you need FOUR winners Friday. Lose Friday and you can buy back in for Saturday ‚Äî but you'll need THREE that day.`
  },
  {
    id:'r3', day:`Saturday R2`, color:'gold',
    heading:`One Pick (or Three on Buyback)`,
    body:`If you nailed Friday, pick just ONE winner Saturday. If you're buying back in after a Friday loss, pick THREE Saturday and go 3-for-3. Max buybacks is three and no buybacks after Sunday.`
  },
  {
    id:'r4', day:`Sunday R2`, color:'gold',
    heading:`One Pick (or Three on Buyback)`,
    body:`Same deal as Saturday. Survived Saturday? Pick one. Buying back in after a Saturday loss? Pick three ‚Äî and go 3-for-3 to stay alive. This is your last chance to buy back in.`
  },
  {
    id:'r5', day:`Sweet 16 onward`, color:'orange',
    heading:`One Pick Per Day`,
    body:`From here on out you pick ONE winner per day. No more buybacks. Last person standing takes the pot. If multiple people survive, they can split or keep playing.`
  },
  {
    id:'r6', day:`All Rounds`, color:'gold',
    heading:`No Team Reuse`,
    body:`You cannot pick the same team twice ‚Äî ever. Even if you buy back in, those previous picks are locked out. If you run out of eligible teams to pick, you automatically advance but lose that day (you still need to be beaten by someone who makes a successful pick).`
  },
];

/* Data now loaded from /api/state ‚Äî see App component */

const getRequiredPicks = (player, day) => {
  if (!player.needsBuyback) {
    if (day === 'thursday_r1' || day === 'friday_r1') return 2;
    return 1;
  }
  if (day === 'friday_r1') return 4;
  return 3;
};

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   MAIN APP
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
function App() {
  // ‚îÄ‚îÄ Loading & Data State ‚îÄ‚îÄ
  const [loading, setLoading] = useState(true);
  const [loadError, setLoadError] = useState(null);
  const [siteLocked, setSiteLocked] = useState(false);
  const [lockMessage, setLockMessage] = useState('');

  // ‚îÄ‚îÄ Data from API ‚îÄ‚îÄ
  const [config, setConfig] = useState(null);
  const [players, setPlayers] = useState([]);
  const [gamesData, setGamesData] = useState({});

  // ‚îÄ‚îÄ UI State ‚îÄ‚îÄ
  const [activeTab, setActiveTab] = useState('standings');
  const [adminTab, setAdminTab] = useState('players');
  const [editingPlayer, setEditingPlayer] = useState(null);

  // ‚îÄ‚îÄ Admin Auth State ‚îÄ‚îÄ
  const [adminAuthed, setAdminAuthed] = useState(false);
  const [adminPassword, setAdminPassword] = useState('');
  const [showAdminLogin, setShowAdminLogin] = useState(false);
  const [adminLoginErr, setAdminLoginErr] = useState('');

  // ‚îÄ‚îÄ Submit Picks State ‚îÄ‚îÄ
  const [pickerName, setPickerName] = useState('');
  const [selectedDay, setSelectedDay] = useState('');
  const [teamPicks, setTeamPicks] = useState(['']);
  const [submitted, setSubmitted] = useState(false);
  const [submitErr, setSubmitErr] = useState('');
  const [submitting, setSubmitting] = useState(false);
  const [buybackPlayerId, setBuybackPlayerId] = useState(null);

  // ‚îÄ‚îÄ Admin action states ‚îÄ‚îÄ
  const [processDay, setProcessDay] = useState('');
  const [processing, setProcessing] = useState(false);
  const [processResult, setProcessResult] = useState(null);
  const [editingGame, setEditingGame] = useState(null);
  const [addingGame, setAddingGame] = useState(null);
  const [newPlayerName, setNewPlayerName] = useState('');

  // ‚îÄ‚îÄ Derived values from config ‚îÄ‚îÄ
  const CURRENT_DAY = config?.currentDay || 'thursday_r1';
  const BUYBACK_DAYS = config?.buybackDays || [];
  const TEAMS = config?.teams || [];
  const buybackOpen = BUYBACK_DAYS.includes(CURRENT_DAY);

  // ‚îÄ‚îÄ Fetch all data from API ‚îÄ‚îÄ
  const fetchState = useCallback(async () => {
    try {
      const headers = {};
      if (adminAuthed && adminPassword) {
        headers['X-Admin-Password'] = adminPassword;
      }
      const resp = await fetch('/api/state', { headers });
      const data = await resp.json();

      if (data.siteLocked && !adminAuthed) {
        setSiteLocked(true);
        setLockMessage(data.lockMessage || 'The pool is being updated.');
        setLoading(false);
        return;
      }

      setSiteLocked(false);
      setConfig(data.config);
      setPlayers(data.players || []);
      setGamesData(data.games || {});
      if (!selectedDay && data.config?.currentDay) {
        setSelectedDay(data.config.currentDay);
      }
      if (!processDay && data.config?.currentDay) {
        setProcessDay(data.config.currentDay);
      }
      setLoading(false);
      setLoadError(null);
    } catch (err) {
      setLoadError('Failed to load pool data. Please refresh.');
      setLoading(false);
    }
  }, [adminAuthed, adminPassword]);

  useEffect(() => {
    fetchState();
    const interval = setInterval(fetchState, 30000);
    return () => clearInterval(interval);
  }, [fetchState]);

  const alivePlayers = useMemo(() => players.filter(p => p.status === 'alive'), [players]);
  const eliminatedPlayers = useMemo(() => players.filter(p => p.status === 'eliminated'), [players]);

  // ‚îÄ‚îÄ Admin auth helper ‚îÄ‚îÄ
  const adminHeaders = () => ({
    'Content-Type': 'application/json',
    'X-Admin-Password': adminPassword,
  });

  const handleAdminLogin = async () => {
    setAdminLoginErr('');
    try {
      const resp = await fetch('/api/admin/auth', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ password: adminPassword }),
      });
      if (resp.ok) {
        setAdminAuthed(true);
        setShowAdminLogin(false);
        setActiveTab('admin');
        fetchState();
      } else {
        setAdminLoginErr('Invalid password.');
      }
    } catch { setAdminLoginErr('Connection error.'); }
  };

  const handleAdminLogout = () => {
    setAdminAuthed(false);
    setAdminPassword('');
    setActiveTab('standings');
    fetchState();
  };

  const handleTabChange = useCallback((tab) => {
    setActiveTab(tab);
    setSubmitted(false);
    setSubmitErr('');
    if (tab !== 'picks') setBuybackPlayerId(null);
  }, []);

  const handleBuyBack = (player) => {
    setBuybackPlayerId(player.id);
    setPickerName(player.name);
    setSelectedDay(CURRENT_DAY);
    setTeamPicks(['']);
    setSubmitted(false);
    setSubmitErr('');
    setActiveTab('picks');
  };

  const handlePickCountChange = (idx, val) => {
    const picks = [...teamPicks];
    picks[idx] = val;
    setTeamPicks(picks);
  };
  const addPickSlot = () => setTeamPicks([...teamPicks, '']);
  const removePickSlot = (idx) => setTeamPicks(teamPicks.filter((_,i) => i !== idx));

  // ‚îÄ‚îÄ Submit picks via API ‚îÄ‚îÄ
  const handleSubmitPicks = async () => {
    setSubmitErr('');
    if (!pickerName.trim()) { setSubmitErr('Please enter your name.'); return; }
    const filled = teamPicks.filter(t => t.trim());
    if (filled.length === 0) { setSubmitErr('Please select at least one team.'); return; }

    const player = players.find(p => p.name.toLowerCase() === pickerName.trim().toLowerCase());
    if (!player) { setSubmitErr('Player not found. Check your name.'); return; }

    setSubmitting(true);
    try {
      const resp = await fetch('/api/picks', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          playerId: player.id,
          day: selectedDay,
          picks: filled,
          isBuyback: buybackPlayerId !== null,
        }),
      });
      const data = await resp.json();
      if (!resp.ok) {
        setSubmitErr(data.error || 'Failed to submit picks.');
        setSubmitting(false);
        return;
      }
      setSubmitted(true);
      setSubmitting(false);
      fetchState();
    } catch (err) {
      setSubmitErr('Network error. Please try again.');
      setSubmitting(false);
    }
  };

  // ‚îÄ‚îÄ Save player via API ‚îÄ‚îÄ
  const handleSavePlayer = async (updated) => {
    try {
      await fetch('/api/admin/player', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify(updated),
      });
      setEditingPlayer(null);
      fetchState();
    } catch { /* ignore */ }
  };

  // ‚îÄ‚îÄ Add player via API ‚îÄ‚îÄ
  const handleAddPlayer = async () => {
    if (!newPlayerName.trim()) return;
    try {
      await fetch('/api/admin/player', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({ name: newPlayerName.trim() }),
      });
      setNewPlayerName('');
      fetchState();
    } catch { /* ignore */ }
  };

  // ‚îÄ‚îÄ Delete player via API ‚îÄ‚îÄ
  const handleDeletePlayer = async (id) => {
    try {
      await fetch(`/api/admin/player/${id}`, {
        method: 'DELETE',
        headers: adminHeaders(),
      });
      fetchState();
    } catch { /* ignore */ }
  };

  // ‚îÄ‚îÄ Toggle site lock ‚îÄ‚îÄ
  const handleToggleLock = async () => {
    try {
      const newLocked = !(config?.siteLocked);
      await fetch('/api/admin/config', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({ siteLocked: newLocked }),
      });
      fetchState();
    } catch { /* ignore */ }
  };

  // ‚îÄ‚îÄ Update game result via API ‚îÄ‚îÄ
  const handleSaveGameResult = async (day, game) => {
    try {
      await fetch('/api/admin/game-result', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({
          day,
          gameId: game.id,
          homeScore: game.homeScore,
          awayScore: game.awayScore,
          final: game.final,
          winner: game.winner,
        }),
      });
      setEditingGame(null);
      fetchState();
    } catch { /* ignore */ }
  };

  // ‚îÄ‚îÄ Add game via API ‚îÄ‚îÄ
  const handleAddGame = async (day, game) => {
    const allGames = { ...gamesData };
    const dayGames = [...(allGames[day] || [])];
    dayGames.push(game);
    try {
      await fetch('/api/admin/games', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({ day, games: dayGames }),
      });
      setAddingGame(null);
      fetchState();
    } catch { /* ignore */ }
  };

  // ‚îÄ‚îÄ Process day via API ‚îÄ‚îÄ
  const handleProcessDay = async () => {
    setProcessing(true);
    setProcessResult(null);
    try {
      const resp = await fetch('/api/admin/process-day', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({ day: processDay }),
      });
      const data = await resp.json();
      setProcessResult(data);
      setProcessing(false);
      fetchState();
    } catch {
      setProcessResult({ error: 'Failed to process day.' });
      setProcessing(false);
    }
  };

  const TABS = [
    {id:'standings', label:'Standings'},
    {id:'scores',    label:'Scores'},
    {id:'picks',     label:'Submit Picks'},
    {id:'rules',     label:'Rules'},
  ];
  if (adminAuthed) TABS.push({id:'admin', label:'Admin'});

  const totalPot = players.reduce((s, p) => s + p.totalSpent, 0);

  /* ‚îÄ‚îÄ Loading screen ‚îÄ‚îÄ */
  if (loading) {
    return (
      <div style={{minHeight:'100vh', background:'var(--bg)', display:'flex', alignItems:'center', justifyContent:'center'}}>
        <div style={{textAlign:'center'}}>
          <Basketball size={80} spin={true} glow={true} />
          <div className="anton" style={{fontSize:20, color:'var(--cream)', marginTop:20, letterSpacing:'0.04em'}}>
            LOADING POOL DATA...
          </div>
        </div>
      </div>
    );
  }

  /* ‚îÄ‚îÄ Error screen ‚îÄ‚îÄ */
  if (loadError) {
    return (
      <div style={{minHeight:'100vh', background:'var(--bg)', display:'flex', alignItems:'center', justifyContent:'center'}}>
        <div className="card" style={{maxWidth:440, padding:'40px 32px', textAlign:'center'}}>
          <div className="anton" style={{fontSize:24, color:'var(--danger)', marginTop:8}}>CONNECTION ERROR</div>
          <div style={{color:'var(--muted)', marginTop:12, lineHeight:1.6}}>{loadError}</div>
          <button className="btn btn-primary" style={{marginTop:20}} onClick={() => { setLoading(true); setLoadError(null); fetchState(); }}>
            Retry
          </button>
        </div>
      </div>
    );
  }

  /* ‚îÄ‚îÄ Site locked screen (non-admin) ‚îÄ‚îÄ */
  if (siteLocked && !adminAuthed) {
    return (
      <div style={{minHeight:'100vh', background:'var(--bg)', display:'flex', alignItems:'center', justifyContent:'center'}}>
        <div className="card" style={{maxWidth:440, padding:'40px 32px', textAlign:'center'}}>
          <Basketball size={72} bounce={true} glow={true} />
          <div className="anton" style={{fontSize:24, color:'var(--gold)', marginTop:20, letterSpacing:'0.04em'}}>
            POOL MAINTENANCE
          </div>
          <div style={{color:'var(--muted)', marginTop:12, lineHeight:1.6}}>{lockMessage}</div>
          <button className="btn btn-ghost" style={{marginTop:20}} onClick={() => setShowAdminLogin(true)}>
            Admin Login
          </button>
          {showAdminLogin && (
            <div style={{marginTop:16}}>
              <input className="form-input" type="password" placeholder="Admin password"
                     value={adminPassword} onChange={e => setAdminPassword(e.target.value)}
                     onKeyDown={e => e.key === 'Enter' && handleAdminLogin()}
                     style={{marginBottom:8}} />
              {adminLoginErr && <div style={{color:'var(--danger)', fontSize:13, marginBottom:8}}>{adminLoginErr}</div>}
              <button className="btn btn-primary" style={{width:'100%', justifyContent:'center'}} onClick={handleAdminLogin}>
                Login
              </button>
            </div>
          )}
        </div>
      </div>
    );
  }

  return (
    <div style={{minHeight:'100vh', background:'var(--bg)'}}>

      {/* Admin Login Modal */}
      {showAdminLogin && !adminAuthed && (
        <div style={{position:'fixed', inset:0, background:'rgba(0,0,0,.75)', display:'flex', alignItems:'center', justifyContent:'center', zIndex:1000, padding:16, backdropFilter:'blur(4px)'}}>
          <div className="card" style={{width:'100%', maxWidth:380}}>
            <div className="card-header">
              <div className="card-title">Admin Login</div>
              <button className="btn btn-ghost" style={{padding:'5px 10px'}} onClick={() => { setShowAdminLogin(false); setAdminLoginErr(''); }}>‚úï</button>
            </div>
            <div style={{padding:'20px 22px'}}>
              <label className="form-label">Password</label>
              <input className="form-input" type="password" placeholder="Enter admin password"
                     value={adminPassword} onChange={e => setAdminPassword(e.target.value)}
                     onKeyDown={e => e.key === 'Enter' && handleAdminLogin()} />
              {adminLoginErr && <div style={{color:'var(--danger)', fontSize:13, marginTop:8}}>{adminLoginErr}</div>}
              <button className="btn btn-primary" style={{width:'100%', justifyContent:'center', marginTop:14}} onClick={handleAdminLogin}>
                Login
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Venmo Bar */}
      <div className="venmo-bar">
        <a href="https://www.venmo.com/Ryan-Keefer-2" target="_blank" rel="noopener noreferrer"
           style={{color:'#fff', textDecoration:'none'}}>
          Pay Entry Fee via Venmo @Ryan-Keefer-2
        </a>
      </div>

      {/* Site locked banner for admin */}
      {config?.siteLocked && adminAuthed && (
        <div style={{background:'rgba(248,113,113,.15)', borderBottom:'1px solid rgba(248,113,113,.3)', padding:'6px 16px', textAlign:'center', fontSize:12, fontWeight:700, color:'var(--danger)', letterSpacing:'0.05em'}}>
          SITE IS LOCKED ‚Äî Only you can see the pool right now
        </div>
      )}

      {/* Header */}
      <header className="site-header">
        <div className="header-flame" />
        <div style={{maxWidth:1100, margin:'0 auto', padding:'0 16px', position:'relative'}}>
          <div style={{display:'flex', alignItems:'center', justifyContent:'space-between', padding:'16px 0 0'}}>
            <div style={{display:'flex', alignItems:'center', gap:16}}>
              <Basketball size={44} spin={true} glow={true} />
              <div>
                <div className="anton" style={{fontSize:22, color:'var(--cream)', lineHeight:1.1, letterSpacing:'0.04em'}}>
                  MARCH MADNESS
                </div>
                <div className="mono" style={{fontSize:11, color:'var(--accent)', letterSpacing:'0.12em', marginTop:1}}>
                  KNOCKOUT POOL ‚Äî 2025
                </div>
              </div>
            </div>
            <div style={{display:'flex', alignItems:'center', gap:12}}>
              <div style={{textAlign:'right', marginRight:4}}>
                <div className="mono" style={{fontSize:26, color:'var(--gold)', fontWeight:700, lineHeight:1}}>
                  ${totalPot.toLocaleString()}
                </div>
                <div style={{fontSize:10, color:'var(--muted)', letterSpacing:'0.06em', textTransform:'uppercase', marginTop:4}}>Total Pot</div>
              </div>
              {adminAuthed ? (
                <button className="btn btn-ghost" style={{padding:'6px 14px', fontSize:11}} onClick={handleAdminLogout}>
                  Logout Admin
                </button>
              ) : (
                <button className="btn btn-ghost" style={{padding:'6px 14px', fontSize:11}} onClick={() => setShowAdminLogin(true)}>
                  Admin
                </button>
              )}
            </div>
          </div>

          {/* Nav */}
          <div style={{display:'flex', gap:0, overflowX:'auto', marginTop:4}}>
            {TABS.map(tab => (
              <div key={tab.id} className={`nav-tab ${activeTab === tab.id ? 'active' : ''}`}
                   onClick={() => handleTabChange(tab.id)}>
                {tab.label}
              </div>
            ))}
          </div>
        </div>
      </header>

      {/* Main Content */}
      <main style={{maxWidth:1100, margin:'0 auto', padding:'28px 16px 60px'}}>

        {/* ‚îÄ‚îÄ STANDINGS ‚îÄ‚îÄ */}
        {activeTab === 'standings' && (
          <div className="anim-up">
            {/* Stats Row */}
            <div style={{display:'grid', gridTemplateColumns:'repeat(auto-fit, minmax(160px,1fr))', gap:14, marginBottom:28}}>
              <div className="stat-card green anim-up anim-up-1">
                <div className="mono" style={{fontSize:28, fontWeight:700, color:'var(--success)', lineHeight:1}}>{alivePlayers.length}</div>
                <div style={{fontSize:11, color:'var(--muted)', marginTop:6, letterSpacing:'0.08em', textTransform:'uppercase'}}>Still Alive</div>
              </div>
              <div className="stat-card red anim-up anim-up-2">
                <div className="mono" style={{fontSize:28, fontWeight:700, color:'#f87171', lineHeight:1}}>{eliminatedPlayers.length}</div>
                <div style={{fontSize:11, color:'var(--muted)', marginTop:6, letterSpacing:'0.08em', textTransform:'uppercase'}}>Eliminated</div>
              </div>
              <div className="stat-card white anim-up anim-up-3">
                <div className="mono" style={{fontSize:28, fontWeight:700, color:'#e5e7eb', lineHeight:1}}>{DAY_LABELS[CURRENT_DAY]}</div>
                <div style={{fontSize:11, color:'var(--muted)', marginTop:6, letterSpacing:'0.08em', textTransform:'uppercase'}}>Current Round</div>
              </div>
            </div>

            {/* Alive Players */}
            <div className="card anim-up anim-up-2" style={{marginBottom:20}}>
              <div className="card-header">
                <div className="card-title" style={{color:'var(--success)'}}>Still Alive</div>
                <span className="badge badge-alive">{alivePlayers.length} alive</span>
              </div>
              {[...alivePlayers].sort((a,b) => a.name.localeCompare(b.name)).map((p, i) => (
                <div key={p.id} className="player-row" style={{animationDelay: `${(i+3)*60}ms`}}>
                  <div style={{flex:1}}>
                    <div style={{fontWeight:700, color:'var(--cream)', fontSize:15}}>{p.name}</div>
                    <div style={{fontSize:12, color:'var(--muted)', marginTop:1}}>
                      {p.buybacks > 0 ? `${p.buybacks} buyback${p.buybacks > 1 ? 's' : ''}` : 'No buybacks'} ¬∑ ${p.totalSpent} in
                    </div>
                  </div>
                  <div style={{display:'flex', flexWrap:'wrap', gap:4, justifyContent:'flex-end'}}>
                    {DAY_ORDER.slice(0,7).map(day => {
                      const result = p.results[day];
                      if (!result) return null;
                      return (
                        <span key={day} className={`badge ${result === 'win' ? 'badge-win' : result === 'loss' ? 'badge-loss' : 'badge-pending'}`}
                              style={{fontSize:10}}>
                          {DAY_LABELS[day]} {result === 'win' ? '‚úì' : result === 'loss' ? '‚úó' : '‚Äî'}
                        </span>
                      );
                    })}
                  </div>
                </div>
              ))}
            </div>

            {/* Eliminated Players */}
            {eliminatedPlayers.length > 0 && (
              <div className="card anim-up anim-up-5">
                <div className="card-header">
                  <div className="card-title" style={{color:'var(--danger)'}}>Eliminated</div>
                  <span className="badge badge-out">{eliminatedPlayers.length} out</span>
                </div>
                {[...eliminatedPlayers].sort((a,b) => a.name.localeCompare(b.name)).map((p, i) => (
                  <div key={p.id} className="player-row" style={{opacity: buybackOpen && p.buybacks < 3 ? 1 : .7}}>
                    <div style={{flex:1}}>
                      <div style={{fontWeight:600, color: buybackOpen && p.buybacks < 3 ? 'var(--cream)' : 'var(--muted)', textDecoration: buybackOpen && p.buybacks < 3 ? 'none' : 'line-through', fontSize:15}}>{p.name}</div>
                      <div style={{fontSize:12, color:'var(--dim)', marginTop:1}}>
                        {p.buybacks} buyback{p.buybacks !== 1 ? 's' : ''} ¬∑ ${p.totalSpent} spent
                      </div>
                    </div>
                    {buybackOpen && p.buybacks < 3 && (
                      <button className="btn btn-gold" style={{padding:'7px 18px', fontSize:12, flexShrink:0, marginLeft:8}}
                              onClick={() => handleBuyBack(p)}>
                        Buy Back In ‚Äî $25
                      </button>
                    )}
                    <div style={{display:'flex', flexWrap:'wrap', gap:4, justifyContent:'flex-end'}}>
                      {DAY_ORDER.map(day => {
                        const result = p.results[day];
                        if (!result) return null;
                        return (
                          <span key={day} className={`badge ${result === 'win' ? 'badge-win' : 'badge-loss'}`}
                                style={{fontSize:10}}>
                            {DAY_LABELS[day]} {result === 'win' ? '‚úì' : '‚úó'}
                          </span>
                        );
                      })}
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        )}

        {/* ‚îÄ‚îÄ SCORES ‚îÄ‚îÄ */}
        {activeTab === 'scores' && (
          <div className="anim-up">
            {Object.entries(gamesData).map(([day, games]) => (
              <div key={day} style={{marginBottom:24}}>
                <div style={{display:'flex', alignItems:'center', gap:10, marginBottom:12}}>
                  <div className="anton" style={{fontSize:16, color:'var(--cream)', letterSpacing:'0.05em'}}>{DAY_FULL[day]}</div>
                  {day === CURRENT_DAY && (
                    <span className="badge badge-pending" style={{animation:'glow-pulse 1.5s ease-in-out infinite'}}>Live</span>
                  )}
                </div>
                <div className="card">
                  {games.map((game, idx) => (
                    <div key={game.id} className="game-row">
                      <div style={{display:'flex', alignItems:'center', gap:10}}>
                        <div style={{flex:1}}>
                          <div style={{display:'flex', alignItems:'center', gap:8}}>
                            <span style={{
                              fontWeight: game.winner === game.home ? 700 : 400,
                              color: game.winner === game.home ? 'var(--cream)' : 'var(--muted)',
                              fontSize: 14,
                            }}>{game.home}</span>
                            {game.final && game.winner === game.home && (
                              <span className="badge badge-win" style={{fontSize:9}}>W</span>
                            )}
                          </div>
                          <div style={{display:'flex', alignItems:'center', gap:8, marginTop:4}}>
                            <span style={{
                              fontWeight: game.winner === game.away ? 700 : 400,
                              color: game.winner === game.away ? 'var(--cream)' : 'var(--muted)',
                              fontSize: 14,
                            }}>{game.away}</span>
                            {game.final && game.winner === game.away && (
                              <span className="badge badge-win" style={{fontSize:9}}>W</span>
                            )}
                          </div>
                        </div>
                        <div style={{textAlign:'right', minWidth:80}}>
                          {game.final ? (
                            <div>
                              <div className="mono" style={{fontSize:15, fontWeight:700, color:'var(--text)'}}>{game.homeScore}</div>
                              <div className="mono" style={{fontSize:15, fontWeight:700, color:'var(--text)', marginTop:4}}>{game.awayScore}</div>
                            </div>
                          ) : (
                            <span className="badge badge-pending" style={{fontSize:10}}>
                              {game.homeScore !== null ? `${game.homeScore}-${game.awayScore}` : 'TBD'}
                            </span>
                          )}
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            ))}
          </div>
        )}

        {/* ‚îÄ‚îÄ SUBMIT PICKS ‚îÄ‚îÄ */}
        {activeTab === 'picks' && (
          <div className="anim-up" style={{maxWidth:560}}>
            {submitted ? (
              <div className="card" style={{padding:'40px 32px', textAlign:'center'}}>
                <Basketball size={72} bounce={true} glow={true} className="" />
                <div className="anton" style={{fontSize:28, color: buybackPlayerId ? 'var(--gold)' : 'var(--success)', marginTop:20, letterSpacing:'0.04em'}}>
                  {buybackPlayerId ? `YOU'RE BACK IN!` : `PICKS LOCKED IN`}
                </div>
                <div style={{color:'var(--muted)', marginTop:8}}>
                  {pickerName} ‚Äî {DAY_LABELS[selectedDay]}
                </div>
                {buybackPlayerId && (
                  <div style={{fontSize:13, color:'var(--gold)', marginTop:6}}>
                    Buyback confirmed ¬∑ $25 added to pot
                  </div>
                )}
                <div style={{marginTop:16, display:'flex', flexWrap:'wrap', gap:8, justifyContent:'center'}}>
                  {teamPicks.filter(t=>t).map(t => (
                    <span key={t} className="badge badge-pending" style={{fontSize:13, padding:'5px 14px'}}>{t}</span>
                  ))}
                </div>
                <div style={{display:'flex', gap:10, marginTop:24, justifyContent:'center'}}>
                  <button className="btn btn-ghost"
                          onClick={() => { setSubmitted(false); setTeamPicks(['']); setPickerName(''); setBuybackPlayerId(null); }}>
                    Submit Another
                  </button>
                  <button className="btn btn-primary" onClick={() => { handleTabChange('standings'); }}>
                    View Standings
                  </button>
                </div>
              </div>
            ) : (
              <div>
                {buybackPlayerId && (
                  <div style={{
                    background:'rgba(255,184,0,.1)', border:'1px solid rgba(255,184,0,.3)',
                    borderRadius:10, padding:'12px 18px', marginBottom:14,
                    display:'flex', alignItems:'center', gap:10
                  }}>
                    <span style={{fontSize:18}}>üèÄ</span>
                    <div>
                      <div style={{fontWeight:700, color:'var(--gold)', fontSize:13, letterSpacing:'0.05em', textTransform:'uppercase'}}>Buying Back In</div>
                      <div style={{fontSize:12, color:'var(--muted)', marginTop:2}}>$25 buyback ¬∑ pick your teams below to re-enter</div>
                    </div>
                  </div>
                )}
                <div className="card" style={{padding:'24px 26px', marginBottom:20}}>
                  <div className="anton" style={{fontSize:18, color:'var(--cream)', letterSpacing:'0.05em', marginBottom:18}}>
                    {buybackPlayerId ? `BUYBACK PICKS` : `SUBMIT YOUR PICKS`}
                  </div>

                  <div style={{marginBottom:16}}>
                    <label className="form-label">Your Name</label>
                    <input className="form-input" placeholder="Enter your name"
                           value={pickerName} onChange={e => setPickerName(e.target.value)} />
                  </div>

                  <div style={{marginBottom:20}}>
                    <label className="form-label">Pick Day</label>
                    <select className="form-select" value={selectedDay} onChange={e => setSelectedDay(e.target.value)}>
                      {DAY_ORDER.map(d => (
                        <option key={d} value={d}>{DAY_FULL[d]}</option>
                      ))}
                    </select>
                  </div>

                  <div style={{marginBottom:8}}>
                    <label className="form-label">Team Picks</label>
                    {teamPicks.map((pick, idx) => (
                      <div key={idx} style={{display:'flex', gap:8, marginBottom:8}}>
                        <select className="form-select" value={pick} onChange={e => handlePickCountChange(idx, e.target.value)}>
                          <option value="">Select team‚Ä¶</option>
                          {TEAMS.map(t => <option key={t} value={t}>{t}</option>)}
                        </select>
                        {teamPicks.length > 1 && (
                          <button className="btn btn-ghost" style={{padding:'10px 14px', flexShrink:0}}
                                  onClick={() => removePickSlot(idx)}>‚úï</button>
                        )}
                      </div>
                    ))}
                    <button className="btn btn-ghost" style={{marginTop:4, width:'100%', justifyContent:'center'}}
                            onClick={addPickSlot}>
                      + Add Pick
                    </button>
                  </div>

                  {submitErr && (
                    <div style={{color:'var(--danger)', fontSize:13, marginBottom:12, padding:'10px 14px',
                                 background:'rgba(248,113,113,.08)', border:'1px solid rgba(248,113,113,.2)', borderRadius:8}}>
                      {submitErr}
                    </div>
                  )}

                  <button className="btn btn-primary" style={{width:'100%', justifyContent:'center', marginTop:8}}
                          onClick={handleSubmitPicks} disabled={submitting}>
                    {submitting ? 'Submitting...' : 'Lock In Picks'}
                  </button>
                </div>

                {/* Pool rules reminder */}
                <div className="card" style={{padding:'20px 22px'}}>
                  <div className="anton" style={{fontSize:13, color:'var(--muted)', letterSpacing:'0.1em', marginBottom:12}}>PICK REQUIREMENTS</div>
                  {[
                    {day:'Thursday R1', req:'2 picks required (4 if buying back after Thursday loss)'},
                    {day:'Friday R1',   req:'2 picks required (4 if buying back after Thursday loss)'},
                    {day:'Saturday R2', req:'1 pick (3 if buying back after Friday loss)'},
                    {day:'Sunday R2',   req:'1 pick (3 if buying back after Saturday loss)'},
                    {day:'Sweet 16+',   req:'1 pick per day ‚Äî no more buybacks'},
                  ].map(r => (
                    <div key={r.day} style={{display:'flex', gap:10, marginBottom:8, fontSize:13}}>
                      <span className="badge badge-pending" style={{flexShrink:0, fontSize:10}}>{r.day}</span>
                      <span style={{color:'var(--muted)'}}>{r.req}</span>
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>
        )}

        {/* ‚îÄ‚îÄ RULES ‚îÄ‚îÄ */}
        {activeTab === 'rules' && (
          <div className="anim-up">
            {/* Big heading with basketball */}
            <div style={{display:'flex', alignItems:'flex-end', gap:20, marginBottom:32}}>
              <div>
                <div className="anton" style={{fontSize:42, color:'var(--cream)', lineHeight:1, letterSpacing:'0.03em'}}>
                  HOW TO PLAY
                </div>
                <div style={{color:'var(--muted)', fontSize:14, marginTop:6, maxWidth:500, lineHeight:1.6}}>
                  Last person standing wins it all. Simple in theory, brutal in practice.
                </div>
              </div>
              <Basketball size={80} bounce={true} glow={true} />
            </div>

            <div style={{display:'grid', gap:14}}>
              {RULES_DATA.map((rule, i) => (
                <div key={rule.id} className={`rule-card ${rule.color} anim-up`} style={{animationDelay: `${i*60}ms`}}>
                  <div style={{display:'flex', alignItems:'center', gap:10, marginBottom:8}}>
                    <span className="badge badge-pending" style={{fontSize:10}}>{rule.day}</span>
                    <div className="anton" style={{fontSize:14, color:'var(--cream)', letterSpacing:'0.05em'}}>
                      {rule.heading}
                    </div>
                  </div>
                  <div style={{color:'var(--muted)', fontSize:14, lineHeight:1.65}}>{rule.body}</div>
                </div>
              ))}
            </div>

            <div style={{
              marginTop:28, padding:'20px 24px',
              background:'rgba(255,184,0,.06)', border:'1px solid rgba(255,184,0,.2)', borderRadius:10
            }}>
              <div className="anton" style={{fontSize:14, color:'var(--gold)', letterSpacing:'0.08em', marginBottom:8}}>
                ENTRY FEE & BUYBACKS
              </div>
              <div style={{color:'var(--muted)', fontSize:14, lineHeight:1.65, marginBottom:14}}>
                Entry is $25. Each buyback costs another $25. Max three buybacks total, no buybacks after Sunday R2.
                Winner takes the entire pot. Multiple survivors can split or keep playing.
              </div>
              <a href="https://www.venmo.com/Ryan-Keefer-2" target="_blank" rel="noopener noreferrer">
                <button className="btn btn-gold">Pay via Venmo</button>
              </a>
            </div>
          </div>
        )}

        {/* ‚îÄ‚îÄ ADMIN ‚îÄ‚îÄ */}
        {activeTab === 'admin' && adminAuthed && (
          <div className="anim-up">
            <div style={{display:'flex', gap:8, marginBottom:20}}>
              {['players','games','process'].map(t => (
                <div key={t} className={`subtab ${adminTab===t?'active':''}`} onClick={() => setAdminTab(t)}>
                  {t.charAt(0).toUpperCase()+t.slice(1)}
                </div>
              ))}
            </div>

            {/* Admin: Players */}
            {adminTab === 'players' && (
              <div>
                <div className="card" style={{marginBottom:16}}>
                  <div className="card-header">
                    <div className="card-title">Player Management</div>
                    <span className="badge badge-alive">{players.length} players</span>
                  </div>
                  <div style={{overflowX:'auto'}}>
                    <table className="admin-table">
                      <thead>
                        <tr>
                          <th>Player</th><th>Status</th><th>Buybacks</th><th>Spent</th><th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        {players.map(p => (
                          <tr key={p.id}>
                            <td>
                              <div style={{display:'flex', alignItems:'center', gap:10}}>
                                <Avatar name={p.name} size={30} />
                                <span style={{fontWeight:600}}>{p.name}</span>
                              </div>
                            </td>
                            <td>
                              <span className={`badge ${p.status==='alive'?'badge-alive':'badge-out'}`}>
                                {p.status}
                              </span>
                            </td>
                            <td><span className="mono" style={{color:'var(--gold)'}}>{p.buybacks}</span></td>
                            <td><span className="mono" style={{color:'var(--accent)'}}>${p.totalSpent}</span></td>
                            <td>
                              <div style={{display:'flex', gap:6}}>
                                <button className="btn btn-ghost" style={{padding:'5px 12px', fontSize:12}}
                                        onClick={() => setEditingPlayer({...p})}>Edit</button>
                                <button className="btn btn-ghost" style={{padding:'5px 12px', fontSize:12, color:'var(--danger)'}}
                                        onClick={() => handleDeletePlayer(p.id)}>Remove</button>
                              </div>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </div>
                {/* Add Player */}
                <div className="card" style={{padding:'18px 22px'}}>
                  <div className="card-title" style={{marginBottom:12}}>Add Player</div>
                  <div style={{display:'flex', gap:10}}>
                    <input className="form-input" placeholder="Player name" value={newPlayerName}
                           onChange={e => setNewPlayerName(e.target.value)}
                           onKeyDown={e => e.key === 'Enter' && handleAddPlayer()} />
                    <button className="btn btn-primary" style={{flexShrink:0}} onClick={handleAddPlayer}>Add</button>
                  </div>
                </div>
              </div>
            )}

            {/* Admin: Games */}
            {adminTab === 'games' && (
              <div>
                <div className="card" style={{marginBottom:16}}>
                  <div className="card-header">
                    <div className="card-title">Game Results</div>
                  </div>
                  <div style={{overflowX:'auto'}}>
                    <table className="admin-table">
                      <thead>
                        <tr><th>Day</th><th>Matchup</th><th>Score</th><th>Winner</th><th>Actions</th></tr>
                      </thead>
                      <tbody>
                        {Object.entries(gamesData).flatMap(([day, games]) =>
                          games.map(g => (
                            <tr key={g.id}>
                              <td><span className="mono" style={{fontSize:12, color:'var(--muted)'}}>{DAY_LABELS[day]}</span></td>
                              <td style={{whiteSpace:'nowrap'}}>{g.home} vs {g.away}</td>
                              <td>
                                {g.final
                                  ? <span className="mono">{g.homeScore}‚Äì{g.awayScore}</span>
                                  : <span className="badge badge-pending" style={{fontSize:10}}>TBD</span>}
                              </td>
                              <td>
                                {g.winner
                                  ? <span className="badge badge-win">{g.winner}</span>
                                  : <span style={{color:'var(--dim)'}}>‚Äî</span>}
                              </td>
                              <td>
                                <button className="btn btn-ghost" style={{padding:'5px 12px', fontSize:12}}
                                        onClick={() => setEditingGame({...g, _day: day})}>Edit</button>
                              </td>
                            </tr>
                          ))
                        )}
                      </tbody>
                    </table>
                  </div>
                </div>
                {/* Add Game */}
                <div className="card" style={{padding:'18px 22px'}}>
                  <div className="card-title" style={{marginBottom:12}}>Add Game</div>
                  {!addingGame ? (
                    <button className="btn btn-ghost" style={{width:'100%', justifyContent:'center'}}
                            onClick={() => setAddingGame({day: CURRENT_DAY, home:'', away:'', id:'g'+Date.now()})}>
                      + Add New Game
                    </button>
                  ) : (
                    <div style={{display:'grid', gap:10}}>
                      <div>
                        <label className="form-label">Day</label>
                        <select className="form-select" value={addingGame.day}
                                onChange={e => setAddingGame({...addingGame, day:e.target.value})}>
                          {DAY_ORDER.map(d => <option key={d} value={d}>{DAY_FULL[d]}</option>)}
                        </select>
                      </div>
                      <div style={{display:'grid', gridTemplateColumns:'1fr 1fr', gap:10}}>
                        <div>
                          <label className="form-label">Home Team</label>
                          <input className="form-input" placeholder="Home" value={addingGame.home}
                                 onChange={e => setAddingGame({...addingGame, home:e.target.value})} />
                        </div>
                        <div>
                          <label className="form-label">Away Team</label>
                          <input className="form-input" placeholder="Away" value={addingGame.away}
                                 onChange={e => setAddingGame({...addingGame, away:e.target.value})} />
                        </div>
                      </div>
                      <div style={{display:'flex', gap:10}}>
                        <button className="btn btn-primary" style={{flex:1, justifyContent:'center'}}
                                onClick={() => handleAddGame(addingGame.day, {id:addingGame.id, home:addingGame.home, away:addingGame.away, homeScore:null, awayScore:null, final:false, winner:null})}>
                          Add Game
                        </button>
                        <button className="btn btn-ghost" onClick={() => setAddingGame(null)}>Cancel</button>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            )}

            {/* Admin: Process */}
            {adminTab === 'process' && (
              <div>
                {/* Site Lock */}
                <div className="card" style={{padding:'22px 24px', marginBottom:16}}>
                  <div className="card-title" style={{marginBottom:14}}>Site Lock</div>
                  <div style={{color:'var(--muted)', fontSize:14, lineHeight:1.65, marginBottom:16}}>
                    Lock the site to prevent players from viewing or submitting picks while you update data.
                  </div>
                  <button className={`btn ${config?.siteLocked ? 'btn-primary' : 'btn-ghost'}`}
                          onClick={handleToggleLock}>
                    {config?.siteLocked ? 'Unlock Site' : 'Lock Site'}
                  </button>
                  {config?.siteLocked && (
                    <span className="badge badge-out" style={{marginLeft:12}}>SITE LOCKED</span>
                  )}
                </div>

                {/* Process Day */}
                <div className="card" style={{padding:'22px 24px', marginBottom:16}}>
                  <div className="card-title" style={{marginBottom:16}}>End-of-Day Processing</div>
                  <div style={{color:'var(--muted)', fontSize:14, lineHeight:1.65, marginBottom:20}}>
                    After all games for a day are final, run end-of-day processing to
                    update player statuses, mark eliminations, flag buyback needs, and advance to the next round.
                  </div>
                  <div style={{display:'flex', gap:10, marginBottom:20}}>
                    <select className="form-select" style={{maxWidth:260}} value={processDay}
                            onChange={e => setProcessDay(e.target.value)}>
                      {DAY_ORDER.map(d => (
                        <option key={d} value={d}>{DAY_FULL[d]}</option>
                      ))}
                    </select>
                    <button className="btn btn-primary" onClick={handleProcessDay} disabled={processing}>
                      {processing ? 'Processing...' : 'Process Day'}
                    </button>
                  </div>
                  {processResult && (
                    <div style={{padding:'14px 18px', background: processResult.error ? 'rgba(248,113,113,.08)' : 'rgba(74,222,128,.08)',
                                 border: `1px solid ${processResult.error ? 'rgba(248,113,113,.2)' : 'rgba(74,222,128,.2)'}`,
                                 borderRadius:8, fontSize:13, marginBottom:16}}>
                      {processResult.error ? (
                        <span style={{color:'var(--danger)'}}>{processResult.error}</span>
                      ) : (
                        <div>
                          <div style={{color:'var(--success)', fontWeight:700, marginBottom:8}}>Day processed successfully</div>
                          <div style={{color:'var(--muted)'}}>Advanced to: {DAY_FULL[processResult.currentDay] || processResult.currentDay}</div>
                          {processResult.summary && processResult.summary.map(p => (
                            <div key={p.id} style={{display:'flex', gap:8, marginTop:4}}>
                              <span style={{color:'var(--cream)'}}>{p.name}</span>
                              <span className={`badge ${p.result === 'win' ? 'badge-win' : p.result === 'loss' ? 'badge-loss' : 'badge-pending'}`} style={{fontSize:10}}>
                                {p.result || 'n/a'}
                              </span>
                              <span style={{color:'var(--muted)', fontSize:12}}>{p.status}</span>
                            </div>
                          ))}
                        </div>
                      )}
                    </div>
                  )}
                  <div style={{padding:'16px 18px', background:'rgba(255,184,0,.06)',
                               border:'1px solid rgba(255,184,0,.2)', borderRadius:8, fontSize:13}}>
                    <span style={{color:'var(--gold)', fontWeight:700}}>Warning: </span>
                    <span style={{color:'var(--muted)'}}>Make sure all scores are entered before processing. Review results carefully.</span>
                  </div>
                </div>

                {/* Pool Summary */}
                <div className="card" style={{padding:'22px 24px'}}>
                  <div className="card-title" style={{marginBottom:14}}>Pool Summary</div>
                  <div style={{display:'grid', gap:10}}>
                    {[
                      {label:'Total Entries',    val:players.length, color:'var(--text)'},
                      {label:'Active Players',   val:alivePlayers.length, color:'var(--success)'},
                      {label:'Eliminated',       val:eliminatedPlayers.length, color:'var(--danger)'},
                      {label:'Total Buybacks',   val:players.reduce((s,p) => s+p.buybacks,0), color:'var(--gold)'},
                      {label:'Total Prize Pool', val:`$${totalPot}`, color:'var(--accent)'},
                      {label:'Current Round',    val:DAY_FULL[CURRENT_DAY], color:'var(--muted)'},
                    ].map(r => (
                      <div key={r.label} style={{display:'flex', justifyContent:'space-between', alignItems:'center',
                                                  padding:'10px 0', borderBottom:'1px solid var(--border)'}}>
                        <span style={{color:'var(--muted)', fontSize:13}}>{r.label}</span>
                        <strong className="mono" style={{color:r.color, fontSize:14}}>{r.val}</strong>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            )}

            {/* Edit Player Modal */}
            {editingPlayer && (
              <div style={{
                position:'fixed', inset:0, background:'rgba(0,0,0,.75)',
                display:'flex', alignItems:'center', justifyContent:'center',
                zIndex:1000, padding:16, backdropFilter:'blur(4px)'
              }}>
                <div className="card" style={{width:'100%', maxWidth:440}}>
                  <div className="card-header">
                    <div className="card-title">Edit Player ‚Äî {editingPlayer.name}</div>
                    <button className="btn btn-ghost" style={{padding:'5px 10px'}}
                            onClick={() => setEditingPlayer(null)}>‚úï</button>
                  </div>
                  <div style={{padding:'20px 22px'}}>
                    <div style={{display:'grid', gap:14}}>
                      <div>
                        <label className="form-label">Name</label>
                        <input className="form-input" value={editingPlayer.name}
                               onChange={e => setEditingPlayer({...editingPlayer, name:e.target.value})} />
                      </div>
                      <div>
                        <label className="form-label">Status</label>
                        <select className="form-select"
                                value={editingPlayer.status}
                                onChange={e => setEditingPlayer({...editingPlayer, status:e.target.value})}>
                          <option value="alive">Alive</option>
                          <option value="eliminated">Eliminated</option>
                        </select>
                      </div>
                      <div>
                        <label className="form-label">Buybacks Used</label>
                        <input type="number" className="form-input" min={0} max={3}
                               value={editingPlayer.buybacks}
                               onChange={e => setEditingPlayer({...editingPlayer, buybacks:parseInt(e.target.value)||0})} />
                      </div>
                      <div>
                        <label className="form-label">Total Spent ($)</label>
                        <input type="number" className="form-input" min={25}
                               value={editingPlayer.totalSpent}
                               onChange={e => setEditingPlayer({...editingPlayer, totalSpent:parseInt(e.target.value)||25})} />
                      </div>
                      <div>
                        <label className="form-label">Needs Buyback</label>
                        <select className="form-select"
                                value={editingPlayer.needsBuyback ? 'true' : 'false'}
                                onChange={e => setEditingPlayer({...editingPlayer, needsBuyback: e.target.value === 'true'})}>
                          <option value="false">No</option>
                          <option value="true">Yes</option>
                        </select>
                      </div>
                    </div>
                    <div style={{display:'flex', gap:10, marginTop:20}}>
                      <button className="btn btn-primary" style={{flex:1, justifyContent:'center'}}
                              onClick={() => handleSavePlayer(editingPlayer)}>Save Changes</button>
                      <button className="btn btn-ghost" onClick={() => setEditingPlayer(null)}>Cancel</button>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* Edit Game Modal */}
            {editingGame && (
              <div style={{
                position:'fixed', inset:0, background:'rgba(0,0,0,.75)',
                display:'flex', alignItems:'center', justifyContent:'center',
                zIndex:1000, padding:16, backdropFilter:'blur(4px)'
              }}>
                <div className="card" style={{width:'100%', maxWidth:440}}>
                  <div className="card-header">
                    <div className="card-title">{editingGame.home} vs {editingGame.away}</div>
                    <button className="btn btn-ghost" style={{padding:'5px 10px'}}
                            onClick={() => setEditingGame(null)}>‚úï</button>
                  </div>
                  <div style={{padding:'20px 22px'}}>
                    <div style={{display:'grid', gap:14}}>
                      <div style={{display:'grid', gridTemplateColumns:'1fr 1fr', gap:10}}>
                        <div>
                          <label className="form-label">{editingGame.home} Score</label>
                          <input type="number" className="form-input"
                                 value={editingGame.homeScore ?? ''}
                                 onChange={e => setEditingGame({...editingGame, homeScore: e.target.value === '' ? null : parseInt(e.target.value)})} />
                        </div>
                        <div>
                          <label className="form-label">{editingGame.away} Score</label>
                          <input type="number" className="form-input"
                                 value={editingGame.awayScore ?? ''}
                                 onChange={e => setEditingGame({...editingGame, awayScore: e.target.value === '' ? null : parseInt(e.target.value)})} />
                        </div>
                      </div>
                      <div>
                        <label className="form-label">Winner</label>
                        <select className="form-select"
                                value={editingGame.winner || ''}
                                onChange={e => setEditingGame({...editingGame, winner: e.target.value || null})}>
                          <option value="">TBD</option>
                          <option value={editingGame.home}>{editingGame.home}</option>
                          <option value={editingGame.away}>{editingGame.away}</option>
                        </select>
                      </div>
                      <div>
                        <label className="form-label">Final</label>
                        <select className="form-select"
                                value={editingGame.final ? 'true' : 'false'}
                                onChange={e => setEditingGame({...editingGame, final: e.target.value === 'true'})}>
                          <option value="false">No (In Progress / TBD)</option>
                          <option value="true">Yes (Final)</option>
                        </select>
                      </div>
                    </div>
                    <div style={{display:'flex', gap:10, marginTop:20}}>
                      <button className="btn btn-primary" style={{flex:1, justifyContent:'center'}}
                              onClick={() => handleSaveGameResult(editingGame._day, editingGame)}>Save Result</button>
                      <button className="btn btn-ghost" onClick={() => setEditingGame(null)}>Cancel</button>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        )}

      </main>

    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
